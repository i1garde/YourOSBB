õ
`C:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Areas\Identity\Pages\Account\Logout.cshtml.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Areas 
. 
Identity %
.% &
Pages& +
.+ ,
Account, 3
{ 
public 

class 
LogoutModel 
: 
	PageModel (
{ 
private 
readonly 
SignInManager &
<& '
ApplicationUser' 6
>6 7
_signInManager8 F
;F G
private 
readonly 
ILogger  
<  !
LogoutModel! ,
>, -
_logger. 5
;5 6
public 
LogoutModel 
( 
SignInManager (
<( )
ApplicationUser) 8
>8 9
signInManager: G
,G H
ILoggerI P
<P Q
LogoutModelQ \
>\ ]
logger^ d
)d e
{ 	
_signInManager 
= 
signInManager *
;* +
_logger 
= 
logger 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
OnPost) /
(/ 0
string0 6
	returnUrl7 @
=A B
nullC G
)G H
{ 	
await 
_signInManager  
.  !
SignOutAsync! -
(- .
). /
;/ 0
_logger 
. 
LogInformation "
(" #
$str# 5
)5 6
;6 7
if 
( 
	returnUrl 
!= 
null !
)! "
{   
return!! 
LocalRedirect!! $
(!!$ %
	returnUrl!!% .
)!!. /
;!!/ 0
}"" 
else## 
{$$ 
return'' 
RedirectToPage'' %
(''% &
)''& '
;''' (
}(( 
})) 	
}** 
}++ àF
_C:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Areas\Identity\Pages\Account\Login.cshtml.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Areas 
. 
Identity %
.% &
Pages& +
.+ ,
Account, 3
{ 
public 

class 

LoginModel 
: 
	PageModel '
{ 
private 
readonly 
SignInManager &
<& '
ApplicationUser' 6
>6 7
_signInManager8 F
;F G
private 
readonly 
ILogger  
<  !

LoginModel! +
>+ ,
_logger- 4
;4 5
private 
readonly 
UserManager $
<$ %
ApplicationUser% 4
>4 5
_userManager6 B
;B C
public 

LoginModel 
( 
SignInManager '
<' (
ApplicationUser( 7
>7 8
signInManager9 F
,F G
ILoggerH O
<O P

LoginModelP Z
>Z [
logger\ b
,b c
UserManager 
< 
ApplicationUser '
>' (
userManager) 4
)4 5
{ 	
_signInManager 
= 
signInManager *
;* +
_logger   
=   
logger   
;   
_userManager!! 
=!! 
userManager!! &
;!!& '
}"" 	
[(( 	
BindProperty((	 
](( 
public)) 

InputModel)) 
Input)) 
{))  !
get))" %
;))% &
set))' *
;))* +
})), -
public// 
IList// 
<//  
AuthenticationScheme// )
>//) *
ExternalLogins//+ 9
{//: ;
get//< ?
;//? @
set//A D
;//D E
}//F G
public55 
string55 
	ReturnUrl55 
{55  !
get55" %
;55% &
set55' *
;55* +
}55, -
[;; 	
TempData;;	 
];; 
public<< 
string<< 
ErrorMessage<< "
{<<# $
get<<% (
;<<( )
set<<* -
;<<- .
}<</ 0
publicBB 
classBB 

InputModelBB 
{CC 	
[HH 
RequiredHH 
]HH 
[II 
EmailAddressII 
]II 
publicJJ 
stringJJ 
EmailJJ 
{JJ  !
getJJ" %
;JJ% &
setJJ' *
;JJ* +
}JJ, -
[PP 
RequiredPP 
]PP 
[QQ 
DataTypeQQ 
(QQ 
DataTypeQQ 
.QQ 
PasswordQQ '
)QQ' (
]QQ( )
publicRR 
stringRR 
PasswordRR "
{RR# $
getRR% (
;RR( )
setRR* -
;RR- .
}RR/ 0
[XX 
DisplayXX 
(XX 
NameXX 
=XX 
$strXX *
)XX* +
]XX+ ,
publicYY 
boolYY 

RememberMeYY "
{YY# $
getYY% (
;YY( )
setYY* -
;YY- .
}YY/ 0
}ZZ 	
public\\ 
async\\ 
Task\\ 

OnGetAsync\\ $
(\\$ %
string\\% +
	returnUrl\\, 5
=\\6 7
null\\8 <
)\\< =
{]] 	
if^^ 
(^^ 
!^^ 
string^^ 
.^^ 
IsNullOrEmpty^^ %
(^^% &
ErrorMessage^^& 2
)^^2 3
)^^3 4
{__ 

ModelState`` 
.`` 
AddModelError`` (
(``( )
string``) /
.``/ 0
Empty``0 5
,``5 6
ErrorMessage``7 C
)``C D
;``D E
}aa 
	returnUrlcc 
??=cc 
Urlcc 
.cc 
Contentcc %
(cc% &
$strcc& *
)cc* +
;cc+ ,
awaitff 
HttpContextff 
.ff 
SignOutAsyncff *
(ff* +
IdentityConstantsff+ <
.ff< =
ExternalSchemeff= K
)ffK L
;ffL M
ExternalLoginshh 
=hh 
(hh 
awaithh #
_signInManagerhh$ 2
.hh2 31
%GetExternalAuthenticationSchemesAsynchh3 X
(hhX Y
)hhY Z
)hhZ [
.hh[ \
ToListhh\ b
(hhb c
)hhc d
;hhd e
	ReturnUrljj 
=jj 
	returnUrljj !
;jj! "
}kk 	
publicmm 
asyncmm 
Taskmm 
<mm 
IActionResultmm '
>mm' (
OnPostAsyncmm) 4
(mm4 5
stringmm5 ;
	returnUrlmm< E
=mmF G
nullmmH L
)mmL M
{nn 	
	returnUrloo 
??=oo 
Urloo 
.oo 
Contentoo %
(oo% &
$stroo& *
)oo* +
;oo+ ,
ExternalLoginsqq 
=qq 
(qq 
awaitqq #
_signInManagerqq$ 2
.qq2 31
%GetExternalAuthenticationSchemesAsyncqq3 X
(qqX Y
)qqY Z
)qqZ [
.qq[ \
ToListqq\ b
(qqb c
)qqc d
;qqd e
ifss 
(ss 

ModelStatess 
.ss 
IsValidss "
)ss" #
{tt 
varww 
resultww 
=ww 
awaitww "
_signInManagerww# 1
.ww1 2
PasswordSignInAsyncww2 E
(wwE F
InputwwF K
.wwK L
EmailwwL Q
,wwQ R
InputwwS X
.wwX Y
PasswordwwY a
,wwa b
Inputwwc h
.wwh i

RememberMewwi s
,wws t
lockoutOnFailure	wwu Ö
:
wwÖ Ü
false
wwá å
)
wwå ç
;
wwç é
ifxx 
(xx 
resultxx 
.xx 
	Succeededxx $
)xx$ %
{yy 
_loggerzz 
.zz 
LogInformationzz *
(zz* +
$strzz+ <
)zz< =
;zz= >
var|| 
userRole||  
=||! "
await||# (
_userManager||) 5
.||5 6
FindByEmailAsync||6 F
(||F G
Input||G L
.||L M
Email||M R
)||R S
;||S T
if}} 
(}} 
userRole}}  
.}}  !
Role}}! %
==}}& (
$str}}) 6
)}}6 7
{~~ 
return 
LocalRedirect ,
(, -
Url- 0
.0 1
Content1 8
(8 9
$str9 O
)O P
)P Q
;Q R
}
ÄÄ 
if
ÅÅ 
(
ÅÅ 
userRole
ÅÅ  
.
ÅÅ  !
Role
ÅÅ! %
==
ÅÅ& (
$str
ÅÅ) 4
)
ÅÅ4 5
{
ÇÇ 
return
ÉÉ 
LocalRedirect
ÉÉ ,
(
ÉÉ, -
Url
ÉÉ- 0
.
ÉÉ0 1
Content
ÉÉ1 8
(
ÉÉ8 9
$str
ÉÉ9 O
)
ÉÉO P
)
ÉÉP Q
;
ÉÉQ R
}
ÑÑ 
return
ÖÖ 
LocalRedirect
ÖÖ (
(
ÖÖ( )
	returnUrl
ÖÖ) 2
)
ÖÖ2 3
;
ÖÖ3 4
}
ÜÜ 
if
áá 
(
áá 
result
áá 
.
áá 
RequiresTwoFactor
áá ,
)
áá, -
{
àà 
return
ââ 
RedirectToPage
ââ )
(
ââ) *
$str
ââ* :
,
ââ: ;
new
ââ< ?
{
ââ@ A
	ReturnUrl
ââB K
=
ââL M
	returnUrl
ââN W
,
ââW X

RememberMe
ââY c
=
ââd e
Input
ââf k
.
ââk l

RememberMe
ââl v
}
ââw x
)
ââx y
;
âây z
}
ää 
if
ãã 
(
ãã 
result
ãã 
.
ãã 
IsLockedOut
ãã &
)
ãã& '
{
åå 
_logger
çç 
.
çç 

LogWarning
çç &
(
çç& '
$str
çç' A
)
ççA B
;
ççB C
return
éé 
RedirectToPage
éé )
(
éé) *
$str
éé* 5
)
éé5 6
;
éé6 7
}
èè 
else
êê 
{
ëë 

ModelState
íí 
.
íí 
AddModelError
íí ,
(
íí, -
string
íí- 3
.
íí3 4
Empty
íí4 9
,
íí9 :
$str
íí; S
)
ííS T
;
ííT U
return
ìì 
Page
ìì 
(
ìì  
)
ìì  !
;
ìì! "
}
îî 
}
ïï 
return
òò 
Page
òò 
(
òò 
)
òò 
;
òò 
}
ôô 	
}
öö 
}õõ ©ì
bC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Areas\Identity\Pages\Account\Register.cshtml.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Areas 
. 
Identity %
.% &
Pages& +
.+ ,
Account, 3
{ 
public 

class 
RegisterModel 
:  
	PageModel! *
{ 
private 
readonly 
SignInManager &
<& '
ApplicationUser' 6
>6 7
_signInManager8 F
;F G
private 
readonly 
UserManager $
<$ %
ApplicationUser% 4
>4 5
_userManager6 B
;B C
private 
readonly 

IUserStore #
<# $
ApplicationUser$ 3
>3 4

_userStore5 ?
;? @
private   
readonly   
IUserEmailStore   (
<  ( )
ApplicationUser  ) 8
>  8 9
_emailStore  : E
;  E F
private!! 
readonly!! 
ILogger!!  
<!!  !
RegisterModel!!! .
>!!. /
_logger!!0 7
;!!7 8
private"" 
readonly"" 
IEmailSender"" %
_emailSender""& 2
;""2 3
public$$ 
RegisterModel$$ 
($$ 
UserManager%% 
<%% 
ApplicationUser%% '
>%%' (
userManager%%) 4
,%%4 5

IUserStore&& 
<&& 
ApplicationUser&& &
>&&& '
	userStore&&( 1
,&&1 2
SignInManager'' 
<'' 
ApplicationUser'' )
>'') *
signInManager''+ 8
,''8 9
ILogger(( 
<(( 
RegisterModel(( !
>((! "
logger((# )
,(() *
IEmailSender)) 
emailSender)) $
)))$ %
{** 	
_userManager++ 
=++ 
userManager++ &
;++& '

_userStore,, 
=,, 
	userStore,, "
;,," #
_emailStore-- 
=-- 
GetEmailStore-- '
(--' (
)--( )
;--) *
_signInManager.. 
=.. 
signInManager.. *
;..* +
_logger// 
=// 
logger// 
;// 
_emailSender00 
=00 
emailSender00 &
;00& '
}11 	
[77 	
BindProperty77	 
]77 
public88 

InputModel88 
Input88 
{88  !
get88" %
;88% &
set88' *
;88* +
}88, -
public>> 
string>> 
	ReturnUrl>> 
{>>  !
get>>" %
;>>% &
set>>' *
;>>* +
}>>, -
publicDD 
IListDD 
<DD  
AuthenticationSchemeDD )
>DD) *
ExternalLoginsDD+ 9
{DD: ;
getDD< ?
;DD? @
setDDA D
;DDD E
}DDF G
publicKK 
stringKK 
[KK 
]KK 
MyRolesKK 
=KK  !
newKK" %
[KK% &
]KK& '
{KK( )
$strKK* 7
,KK7 8
$strKK9 D
}KKE F
;KKF G
publicMM 
classMM 

InputModelMM 
{NN 	
[OO 
RequiredOO 
]OO 
[PP 
StringLengthPP 
(PP 
$numPP 
,PP 
ErrorMessagePP +
=PP, -
$strPP. d
)PPd e
]PPe f
[QQ 
DisplayQQ 
(QQ 
NameQQ 
=QQ 
$strQQ "
)QQ" #
]QQ# $
publicRR 
stringRR 
RoleRR 
{RR  
getRR! $
;RR$ %
setRR& )
;RR) *
}RR+ ,
[TT 
RequiredTT 
]TT 
[UU 
StringLengthUU 
(UU 
$numUU 
,UU 
ErrorMessageUU +
=UU, -
$strUU. g
)UUg h
]UUh i
[VV 
DisplayVV 
(VV 
NameVV 
=VV 
$strVV %
)VV% &
]VV& '
publicWW 
stringWW 
SurnameWW !
{WW" #
getWW$ '
;WW' (
setWW) ,
;WW, -
}WW. /
[YY 
RequiredYY 
]YY 
[ZZ 
StringLengthZZ 
(ZZ 
$numZZ 
,ZZ 
ErrorMessageZZ +
=ZZ, -
$strZZ. d
)ZZd e
]ZZe f
[[[ 
Display[[ 
([[ 
Name[[ 
=[[ 
$str[[ "
)[[" #
][[# $
public\\ 
string\\ 
Name\\ 
{\\  
get\\! $
;\\$ %
set\\& )
;\\) *
}\\+ ,
[^^ 
Required^^ 
]^^ 
[__ 
StringLength__ 
(__ 
$num__ 
,__ 
ErrorMessage__ +
=__, -
$str__. o
)__o p
]__p q
[`` 
Display`` 
(`` 
Name`` 
=`` 
$str`` ,
)``, -
]``- .
publicaa 
stringaa 
PatronymicNameaa (
{aa) *
getaa+ .
;aa. /
setaa0 3
;aa3 4
}aa5 6
[ff 
Requiredff 
]ff 
[gg 
EmailAddressgg 
]gg 
[hh 
Displayhh 
(hh 
Namehh 
=hh 
$strhh #
)hh# $
]hh$ %
publicii 
stringii 
Emailii 
{ii  !
getii" %
;ii% &
setii' *
;ii* +
}ii, -
[oo 
Requiredoo 
]oo 
[pp 
StringLengthpp 
(pp 
$numpp 
,pp 
ErrorMessagepp +
=pp, -
$strpp. l
,ppl m
MinimumLengthppn {
=pp| }
$numpp~ 
)	pp Ä
]
ppÄ Å
[qq 
DataTypeqq 
(qq 
DataTypeqq 
.qq 
Passwordqq '
)qq' (
]qq( )
[rr 
Displayrr 
(rr 
Namerr 
=rr 
$strrr &
)rr& '
]rr' (
publicss 
stringss 
Passwordss "
{ss# $
getss% (
;ss( )
setss* -
;ss- .
}ss/ 0
[yy 
DataTypeyy 
(yy 
DataTypeyy 
.yy 
Passwordyy '
)yy' (
]yy( )
[zz 
Displayzz 
(zz 
Namezz 
=zz 
$strzz .
)zz. /
]zz/ 0
[{{ 
Compare{{ 
({{ 
$str{{ 
,{{  
ErrorMessage{{! -
={{. /
$str{{0 f
){{f g
]{{g h
public|| 
string|| 
ConfirmPassword|| )
{||* +
get||, /
;||/ 0
set||1 4
;||4 5
}||6 7
}}} 	
public
ÄÄ 
async
ÄÄ 
Task
ÄÄ 

OnGetAsync
ÄÄ $
(
ÄÄ$ %
string
ÄÄ% +
	returnUrl
ÄÄ, 5
=
ÄÄ6 7
null
ÄÄ8 <
)
ÄÄ< =
{
ÅÅ 	
	ReturnUrl
ÇÇ 
=
ÇÇ 
	returnUrl
ÇÇ !
;
ÇÇ! "
ExternalLogins
ÉÉ 
=
ÉÉ 
(
ÉÉ 
await
ÉÉ #
_signInManager
ÉÉ$ 2
.
ÉÉ2 33
%GetExternalAuthenticationSchemesAsync
ÉÉ3 X
(
ÉÉX Y
)
ÉÉY Z
)
ÉÉZ [
.
ÉÉ[ \
ToList
ÉÉ\ b
(
ÉÉb c
)
ÉÉc d
;
ÉÉd e
}
ÑÑ 	
public
ÜÜ 
async
ÜÜ 
Task
ÜÜ 
<
ÜÜ 
IActionResult
ÜÜ '
>
ÜÜ' (
OnPostAsync
ÜÜ) 4
(
ÜÜ4 5
string
ÜÜ5 ;
	returnUrl
ÜÜ< E
=
ÜÜF G
null
ÜÜH L
)
ÜÜL M
{
áá 	
	returnUrl
àà 
??=
àà 
Url
àà 
.
àà 
Content
àà %
(
àà% &
$str
àà& *
)
àà* +
;
àà+ ,
ExternalLogins
ââ 
=
ââ 
(
ââ 
await
ââ #
_signInManager
ââ$ 2
.
ââ2 33
%GetExternalAuthenticationSchemesAsync
ââ3 X
(
ââX Y
)
ââY Z
)
ââZ [
.
ââ[ \
ToList
ââ\ b
(
ââb c
)
ââc d
;
ââd e
if
ää 
(
ää 

ModelState
ää 
.
ää 
IsValid
ää "
)
ää" #
{
ãã 
var
åå 
role
åå 
=
åå 
Input
åå  
.
åå  !
Role
åå! %
;
åå% &
var
çç 
user
çç 
=
çç 

CreateUser
çç %
(
çç% &
role
çç& *
)
çç* +
;
çç+ ,
user
èè 
.
èè 
Surname
èè 
=
èè 
Input
èè $
.
èè$ %
Surname
èè% ,
;
èè, -
user
êê 
.
êê 
Name
êê 
=
êê 
Input
êê !
.
êê! "
Name
êê" &
;
êê& '
user
ëë 
.
ëë 
PatronymicName
ëë #
=
ëë$ %
Input
ëë& +
.
ëë+ ,
PatronymicName
ëë, :
;
ëë: ;
switch
íí 
(
íí 
role
íí 
)
íí 
{
ìì 
case
îî 
$str
îî &
:
îî& '
user
ïï 
.
ïï 
Role
ïï !
=
ïï" #
MyRoles
ïï$ +
[
ïï+ ,
$num
ïï, -
]
ïï- .
;
ïï. /
break
ññ 
;
ññ 
case
óó 
$str
óó $
:
óó$ %
user
òò 
.
òò 
Role
òò !
=
òò" #
MyRoles
òò$ +
[
òò+ ,
$num
òò, -
]
òò- .
;
òò. /
break
ôô 
;
ôô 
}
öö 
await
úú 

_userStore
úú  
.
úú  !
SetUserNameAsync
úú! 1
(
úú1 2
user
úú2 6
,
úú6 7
Input
úú8 =
.
úú= >
Email
úú> C
,
úúC D
CancellationToken
úúE V
.
úúV W
None
úúW [
)
úú[ \
;
úú\ ]
await
ùù 
_emailStore
ùù !
.
ùù! "
SetEmailAsync
ùù" /
(
ùù/ 0
user
ùù0 4
,
ùù4 5
Input
ùù6 ;
.
ùù; <
Email
ùù< A
,
ùùA B
CancellationToken
ùùC T
.
ùùT U
None
ùùU Y
)
ùùY Z
;
ùùZ [
var
ûû 
result
ûû 
=
ûû 
await
ûû "
_userManager
ûû# /
.
ûû/ 0
CreateAsync
ûû0 ;
(
ûû; <
user
ûû< @
,
ûû@ A
Input
ûûB G
.
ûûG H
Password
ûûH P
)
ûûP Q
;
ûûQ R
if
†† 
(
†† 
result
†† 
.
†† 
	Succeeded
†† $
)
††$ %
{
°° 
_logger
¢¢ 
.
¢¢ 
LogInformation
¢¢ *
(
¢¢* +
$str
¢¢+ V
)
¢¢V W
;
¢¢W X
if
§§ 
(
§§ 
Input
§§ 
.
§§ 
Role
§§ "
==
§§# %
MyRoles
§§& -
[
§§- .
$num
§§. /
]
§§/ 0
)
§§0 1
{
•• 
await
¶¶ 
_userManager
¶¶ *
.
¶¶* +
AddToRoleAsync
¶¶+ 9
(
¶¶9 :
user
¶¶: >
,
¶¶> ?
$str
¶¶@ J
)
¶¶J K
;
¶¶K L
}
ßß 
if
®® 
(
®® 
Input
®® 
.
®® 
Role
®® "
==
®®# %
MyRoles
®®& -
[
®®- .
$num
®®. /
]
®®/ 0
)
®®0 1
{
©© 
await
™™ 
_userManager
™™ *
.
™™* +
AddToRoleAsync
™™+ 9
(
™™9 :
user
™™: >
,
™™> ?
$str
™™@ J
)
™™J K
;
™™K L
}
´´ 
var
≠≠ 
userId
≠≠ 
=
≠≠  
await
≠≠! &
_userManager
≠≠' 3
.
≠≠3 4
GetUserIdAsync
≠≠4 B
(
≠≠B C
user
≠≠C G
)
≠≠G H
;
≠≠H I
var
ÆÆ 
code
ÆÆ 
=
ÆÆ 
await
ÆÆ $
_userManager
ÆÆ% 1
.
ÆÆ1 21
#GenerateEmailConfirmationTokenAsync
ÆÆ2 U
(
ÆÆU V
user
ÆÆV Z
)
ÆÆZ [
;
ÆÆ[ \
code
ØØ 
=
ØØ 
WebEncoders
ØØ &
.
ØØ& '
Base64UrlEncode
ØØ' 6
(
ØØ6 7
Encoding
ØØ7 ?
.
ØØ? @
UTF8
ØØ@ D
.
ØØD E
GetBytes
ØØE M
(
ØØM N
code
ØØN R
)
ØØR S
)
ØØS T
;
ØØT U
var
∞∞ 
callbackUrl
∞∞ #
=
∞∞$ %
Url
∞∞& )
.
∞∞) *
Page
∞∞* .
(
∞∞. /
$str
±± /
,
±±/ 0
pageHandler
≤≤ #
:
≤≤# $
null
≤≤% )
,
≤≤) *
values
≥≥ 
:
≥≥ 
new
≥≥  #
{
≥≥$ %
area
≥≥& *
=
≥≥+ ,
$str
≥≥- 7
,
≥≥7 8
userId
≥≥9 ?
=
≥≥@ A
userId
≥≥B H
,
≥≥H I
code
≥≥J N
=
≥≥O P
code
≥≥Q U
,
≥≥U V
	returnUrl
≥≥W `
=
≥≥a b
	returnUrl
≥≥c l
}
≥≥m n
,
≥≥n o
protocol
¥¥  
:
¥¥  !
Request
¥¥" )
.
¥¥) *
Scheme
¥¥* 0
)
¥¥0 1
;
¥¥1 2
await
∂∂ 
_emailSender
∂∂ &
.
∂∂& '
SendEmailAsync
∂∂' 5
(
∂∂5 6
Input
∂∂6 ;
.
∂∂; <
Email
∂∂< A
,
∂∂A B
$str
∂∂C W
,
∂∂W X
$"
∑∑ 
$str
∑∑ B
{
∑∑B C
HtmlEncoder
∑∑C N
.
∑∑N O
Default
∑∑O V
.
∑∑V W
Encode
∑∑W ]
(
∑∑] ^
callbackUrl
∑∑^ i
)
∑∑i j
}
∑∑j k
$str
∑∑k 
"∑∑ Ä
)∑∑Ä Å
;∑∑Å Ç
if
ππ 
(
ππ 
_userManager
ππ $
.
ππ$ %
Options
ππ% ,
.
ππ, -
SignIn
ππ- 3
.
ππ3 4%
RequireConfirmedAccount
ππ4 K
)
ππK L
{
∫∫ 
return
ªª 
RedirectToPage
ªª -
(
ªª- .
$str
ªª. D
,
ªªD E
new
ªªF I
{
ªªJ K
email
ªªL Q
=
ªªR S
Input
ªªT Y
.
ªªY Z
Email
ªªZ _
,
ªª_ `
	returnUrl
ªªa j
=
ªªk l
	returnUrl
ªªm v
}
ªªw x
)
ªªx y
;
ªªy z
}
ºº 
else
ΩΩ 
{
ææ 
await
øø 
_signInManager
øø ,
.
øø, -
SignInAsync
øø- 8
(
øø8 9
user
øø9 =
,
øø= >
isPersistent
øø? K
:
øøK L
false
øøM R
)
øøR S
;
øøS T
if
¿¿ 
(
¿¿ 
user
¿¿  
.
¿¿  !
Role
¿¿! %
==
¿¿& (
$str
¿¿) 6
)
¿¿6 7
{
¡¡ 
return
¬¬ "
LocalRedirect
¬¬# 0
(
¬¬0 1
Url
¬¬1 4
.
¬¬4 5
Content
¬¬5 <
(
¬¬< =
$str
¬¬= S
)
¬¬S T
)
¬¬T U
;
¬¬U V
}
√√ 
if
ƒƒ 
(
ƒƒ 
user
ƒƒ  
.
ƒƒ  !
Role
ƒƒ! %
==
ƒƒ& (
$str
ƒƒ) 4
)
ƒƒ4 5
{
≈≈ 
return
∆∆ "
LocalRedirect
∆∆# 0
(
∆∆0 1
Url
∆∆1 4
.
∆∆4 5
Content
∆∆5 <
(
∆∆< =
$str
∆∆= S
)
∆∆S T
)
∆∆T U
;
∆∆U V
}
«« 
return
»» 
LocalRedirect
»» ,
(
»», -
	returnUrl
»»- 6
)
»»6 7
;
»»7 8
}
…… 
}
   
foreach
ÀÀ 
(
ÀÀ 
var
ÀÀ 
error
ÀÀ "
in
ÀÀ# %
result
ÀÀ& ,
.
ÀÀ, -
Errors
ÀÀ- 3
)
ÀÀ3 4
{
ÃÃ 

ModelState
ÕÕ 
.
ÕÕ 
AddModelError
ÕÕ ,
(
ÕÕ, -
string
ÕÕ- 3
.
ÕÕ3 4
Empty
ÕÕ4 9
,
ÕÕ9 :
error
ÕÕ; @
.
ÕÕ@ A
Description
ÕÕA L
)
ÕÕL M
;
ÕÕM N
}
ŒŒ 
}
œœ 
return
““ 
Page
““ 
(
““ 
)
““ 
;
““ 
}
”” 	
private
’’ 
ApplicationUser
’’ 

CreateUser
’’  *
(
’’* +
string
’’+ 1
role
’’2 6
)
’’6 7
{
÷÷ 	
try
◊◊ 
{
ÿÿ 
return
ŸŸ 
	Activator
ŸŸ  
.
ŸŸ  !
CreateInstance
ŸŸ! /
<
ŸŸ/ 0
ApplicationUser
ŸŸ0 ?
>
ŸŸ? @
(
ŸŸ@ A
)
ŸŸA B
;
ŸŸB C
}
⁄⁄ 
catch
€€ 
{
‹‹ 
throw
›› 
new
›› '
InvalidOperationException
›› 3
(
››3 4
$"
››4 6
$str
››6 S
{
››S T
nameof
››T Z
(
››Z [
ApplicationUser
››[ j
)
››j k
}
››k l
$str
››l o
"
››o p
+
››q r
$"
ﬁﬁ 
$str
ﬁﬁ #
{
ﬁﬁ# $
nameof
ﬁﬁ$ *
(
ﬁﬁ* +
ApplicationUser
ﬁﬁ+ :
)
ﬁﬁ: ;
}
ﬁﬁ; <
$strﬁﬁ< ç
"ﬁﬁç é
+ﬁﬁè ê
$"
ﬂﬂ 
$str
ﬂﬂ a
"
ﬂﬂa b
)
ﬂﬂb c
;
ﬂﬂc d
}
‡‡ 
}
·· 	
private
„„ 
IUserEmailStore
„„ 
<
„„  
ApplicationUser
„„  /
>
„„/ 0
GetEmailStore
„„1 >
(
„„> ?
)
„„? @
{
‰‰ 	
if
ÂÂ 
(
ÂÂ 
!
ÂÂ 
_userManager
ÂÂ 
.
ÂÂ 
SupportsUserEmail
ÂÂ /
)
ÂÂ/ 0
{
ÊÊ 
throw
ÁÁ 
new
ÁÁ #
NotSupportedException
ÁÁ /
(
ÁÁ/ 0
$str
ÁÁ0 j
)
ÁÁj k
;
ÁÁk l
}
ËË 
return
ÈÈ 
(
ÈÈ 
IUserEmailStore
ÈÈ #
<
ÈÈ# $
ApplicationUser
ÈÈ$ 3
>
ÈÈ3 4
)
ÈÈ4 5

_userStore
ÈÈ5 ?
;
ÈÈ? @
}
ÍÍ 	
}
ÎÎ 
}ÏÏ ¬A
UC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Controllers\ComplaintController.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Controllers "
;" #
public 
class 
ComplaintController  
:! "

Controller# -
{ 
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
UserManager  
<  !
ApplicationUser! 0
>0 1
_userManager2 >
;> ?
private 
readonly 
IOsbbService !
_osbbService" .
;. /
private 
readonly 
IComplaintService &
_complaintService' 8
;8 9
private 
readonly #
IApplicationUserService ,#
_applicationUserService- D
;D E
public 

ComplaintController 
( 
IMapper &
mapper' -
,- .
UserManager 
< 
ApplicationUser #
># $
userManager% 0
,0 1
IOsbbService 
osbbService  
,  !
IComplaintService 
complaintService *
,* +#
IApplicationUserService "
applicationUserService  6
)6 7
{ 
_mapper 
= 
mapper 
; 
_userManager 
= 
userManager "
;" #
_osbbService 
= 
osbbService "
;" #
_complaintService 
= 
complaintService ,
;, -#
_applicationUserService 
=  !"
applicationUserService" 8
;8 9
}   
["" 
	Authorize"" 
("" 
Roles"" 
="" 
$str"" !
)""! "
]""" #
public## 

async## 
Task## 
<## 
IActionResult## #
>### $ 
ShowComplaintsToHead##% 9
(##9 :
)##: ;
{$$ 
var%% 
usr%% 
=%% 
await%% #
_applicationUserService%% /
.%%/ 0
GetUserManager%%0 >
(%%> ?
)%%? @
.%%@ A
GetUserAsync%%A M
(%%M N
HttpContext%%N Y
.%%Y Z
User%%Z ^
)%%^ _
;%%_ `
var&& 
getComplaints&& 
=&& 
await&& !
_complaintService&&" 3
.&&3 4
GetAll&&4 :
(&&: ;
)&&; <
;&&< =
var'' 

complaints'' 
='' 
getComplaints'' &
.''& '
Where''' ,
('', -
x''- .
=>''/ 1
x''2 3
.''3 4
OsbbId''4 :
==''; =
usr''> A
.''A B
OsbbId''B H
)''H I
;''I J
if)) 

()) 

complaints)) 
.)) 
IsNullOrEmpty)) $
())$ %
)))% &
)))& '
{** 	
return++ 
View++ 
(++ 
$str++ ,
)++, -
;++- .
},, 	
return.. 
View.. 
(.. 
$str.. &
,..& '

complaints..( 2
.// 
Select// 
(// 
x// 
=>// 
_mapper//  
.//  !
Map//! $
<//$ %
	Complaint//% .
,//. /
ComplaintViewModel//0 B
>//B C
(//C D
x//D E
)//E F
)//F G
.//G H
ToList//H N
(//N O
)//O P
)//P Q
;//Q R
}00 
[22 
	Authorize22 
(22 
Roles22 
=22 
$str22 !
)22! "
]22" #
public33 

async33 
Task33 
<33 
IActionResult33 #
>33# $%
ShowComplaintsToResidents33% >
(33> ?
)33? @
{44 
var55 
usr55 
=55 
await55 #
_applicationUserService55 /
.55/ 0
GetUserManager550 >
(55> ?
)55? @
.55@ A
GetUserAsync55A M
(55M N
HttpContext55N Y
.55Y Z
User55Z ^
)55^ _
;55_ `
var66 
getComplaints66 
=66 
await66 !
_complaintService66" 3
.663 4
GetAll664 :
(66: ;
)66; <
;66< =
var77 

complaints77 
=77 
getComplaints77 &
.77& '
Where77' ,
(77, -
x77- .
=>77/ 1
x772 3
.773 4
OsbbId774 :
==77; =
usr77> A
.77A B
OsbbId77B H
)77H I
;77I J
if99 

(99 

complaints99 
.99 
IsNullOrEmpty99 $
(99$ %
)99% &
)99& '
{:: 	
return;; 
View;; 
(;; 
$str;; 1
);;1 2
;;;2 3
}<< 	
return>> 
View>> 
(>> 
$str>> +
,>>+ ,

complaints>>- 7
.?? 
Select?? 
(?? 
x?? 
=>?? 
_mapper??  
.??  !
Map??! $
<??$ %
	Complaint??% .
,??. /
ComplaintViewModel??0 B
>??B C
(??C D
x??D E
)??E F
)??F G
.??G H
ToList??H N
(??N O
)??O P
)??P Q
;??Q R
}@@ 
[BB 
	AuthorizeBB 
(BB 
RolesBB 
=BB 
$strBB !
)BB! "
]BB" #
[CC 
HttpGetCC 
]CC 
publicDD 

IActionResultDD 
CreateComplaintDD (
(DD( )
)DD) *
{EE 
returnFF 
ViewFF 
(FF 
$strFF %
)FF% &
;FF& '
}GG 
[II 
	AuthorizeII 
(II 
RolesII 
=II 
$strII !
)II! "
]II" #
[JJ 
HttpPostJJ 
]JJ 
publicKK 

asyncKK 
TaskKK 
<KK 
IActionResultKK #
>KK# $
CreateComplaintKK% 4
(KK4 5
ComplaintViewModelKK5 G
	complaintKKH Q
)KKQ R
{LL 
varMM 
usrMM 
=MM 
awaitMM #
_applicationUserServiceMM /
.MM/ 0
GetUserManagerMM0 >
(MM> ?
)MM? @
.MM@ A
GetUserAsyncMMA M
(MMM N
HttpContextMMN Y
.MMY Z
UserMMZ ^
)MM^ _
;MM_ `
varNN 
osbbTNN 
=NN 
awaitNN 
_osbbServiceNN &
.NN& '
GetAllNN' -
(NN- .
)NN. /
;NN/ 0
varOO 
osbbOO 
=OO 
osbbTOO 
.OO 
WhereOO 
(OO 
xOO  
=>OO! #
xOO$ %
.OO% &
OsbbIdOO& ,
==OO- /
usrOO0 3
.OO3 4
OsbbIdOO4 :
)OO: ;
.OO; <
FirstOO< A
(OOA B
)OOB C
;OOC D
	complaintQQ 
.QQ 
OsbbIdQQ 
=QQ 
osbbQQ 
.QQ  
OsbbIdQQ  &
;QQ& '
	complaintRR 
.RR 
UserIdRR 
=RR 
usrRR 
.RR 
IdRR !
;RR! "
	complaintSS 
.SS 
DateSS 
=SS 
DateTimeSS !
.SS! "
NowSS" %
;SS% &
awaitVV 
_complaintServiceVV 
.VV  
AddVV  #
(VV# $
_mapperVV$ +
.VV+ ,
MapVV, /
<VV/ 0
ComplaintViewModelVV0 B
,VVB C
	ComplaintVVD M
>VVM N
(VVN O
	complaintVVO X
)VVX Y
)VVY Z
;VVZ [
returnXX 
RedirectToActionXX 
(XX  
$strXX  ;
)XX; <
;XX< =
}YY 
}ZZ è$
PC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Controllers\HomeController.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Controllers "
;" #
public		 
class		 
HomeController		 
:		 

Controller		 (
{

 
private 
readonly 
ILogger 
< 
HomeController +
>+ ,
_logger- 4
;4 5
private 
readonly 
SignInManager "
<" #
ApplicationUser# 2
>2 3
_signInManager4 B
;B C
private 
readonly 
UserManager  
<  !
ApplicationUser! 0
>0 1
_userManager2 >
;> ?
public 

HomeController 
( 
ILogger !
<! "
HomeController" 0
>0 1
logger2 8
,8 9
SignInManager 
< 
ApplicationUser %
>% &
signInManager' 4
,4 5
UserManager 
< 
ApplicationUser #
># $
userManager% 0
)0 1
{ 
_logger 
= 
logger 
; 
_signInManager 
= 
signInManager &
;& '
_userManager 
= 
userManager "
;" #
} 
public 

async 
Task 
< 
IActionResult #
># $
Index% *
(* +
)+ ,
{ 
if 

( 
_signInManager 
. 

IsSignedIn %
(% &
User& *
)* +
)+ ,
{ 	
var 
usr 
= 
await 
_userManager (
.( )
GetUserAsync) 5
(5 6
HttpContext6 A
.A B
UserB F
)F G
;G H
if 
( 
usr 
== 
null 
) 
{ 
await 
_signInManager $
.$ %
SignOutAsync% 1
(1 2
)2 3
;3 4
return   
RedirectToAction   '
(  ' (
$str  ( /
)  / 0
;  0 1
}!! 
var"" 
userRole"" 
="" 
await""  
_userManager""! -
.""- .
FindByEmailAsync"". >
(""> ?
usr""? B
.""B C
Email""C H
)""H I
;""I J
if## 
(## 
userRole## 
.## 
Role## 
==##  
$str##! .
)##. /
{$$ 
return%% 
LocalRedirect%% $
(%%$ %
Url%%% (
.%%( )
Content%%) 0
(%%0 1
$str%%1 G
)%%G H
)%%H I
;%%I J
}&& 
if'' 
('' 
userRole'' 
.'' 
Role'' 
==''  
$str''! ,
)'', -
{(( 
return)) 
LocalRedirect)) $
())$ %
Url))% (
.))( )
Content))) 0
())0 1
$str))1 G
)))G H
)))H I
;))I J
}** 
}++ 	
return,, 
View,, 
(,, 
),, 
;,, 
}-- 
public// 

IActionResult// 
Privacy//  
(//  !
)//! "
{00 
return11 
View11 
(11 
)11 
;11 
}22 
[44 
ResponseCache44 
(44 
Duration44 
=44 
$num44 
,44  
Location44! )
=44* +!
ResponseCacheLocation44, A
.44A B
None44B F
,44F G
NoStore44H O
=44P Q
true44R V
)44V W
]44W X
public55 

IActionResult55 
Error55 
(55 
)55  
{66 
return77 
View77 
(77 
new77 
ErrorViewModel77 &
{77' (
	RequestId77) 2
=773 4
Activity775 =
.77= >
Current77> E
?77E F
.77F G
Id77G I
??77J L
HttpContext77M X
.77X Y
TraceIdentifier77Y h
}77i j
)77j k
;77k l
}88 
}99 ŸR
TC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Controllers\OsbbHeadController.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Controllers "
;" #
public 
class 
OsbbHeadController 
:  !

Controller" ,
{ 
private 
readonly 
UserManager  
<  !
ApplicationUser! 0
>0 1
_userManager2 >
;> ?
private 
readonly 
IOsbbService !
_osbbService" .
;. /
private 
readonly #
IApplicationUserService ,#
_applicationUserService- D
;D E
private 
readonly  
IAnnouncementService ) 
_announcementService* >
;> ?
private 
readonly 
IMapper 
_mapper $
;$ %
public 

OsbbHeadController 
( 
IMapper %
mapper& ,
,, -
UserManager 
< 
ApplicationUser #
># $
userManager% 0
,0 1
IOsbbService 
osbbService  
,  ! 
IAnnouncementService 
announcementService 0
,0 1#
IApplicationUserService "
applicationUserService  6
)6 7
{ 
_mapper 
= 
mapper 
; 
_userManager 
= 
userManager "
;" #
_osbbService   
=   
osbbService   "
;  " # 
_announcementService!! 
=!! 
announcementService!! 2
;!!2 3#
_applicationUserService"" 
=""  !"
applicationUserService""" 8
;""8 9
}## 
[&& 
	Authorize&& 
(&& 
Roles&& 
=&& 
$str&& !
)&&! "
]&&" #
public'' 

IActionResult'' 
OsbbHead'' !
(''! "
)''" #
{(( 
return)) 
View)) 
()) 
))) 
;)) 
}** 
[,, 
	Authorize,, 
(,, 
Roles,, 
=,, 
$str,, !
),,! "
],," #
public-- 

async-- 
Task-- 
<-- 
IActionResult-- #
>--# $
Osbb--% )
(--) *
)--* +
{.. 
var// 
usr// 
=// 
await// 
_userManager// $
.//$ %
GetUserAsync//% 1
(//1 2
HttpContext//2 =
.//= >
User//> B
)//B C
;//C D
var00 
userOsbb00 
=00 
await00 
_userManager00 )
.00) *
FindByEmailAsync00* :
(00: ;
usr00; >
.00> ?
Email00? D
)00D E
;00E F
if11 

(11 
userOsbb11 
.11 
OsbbId11 
==11 
null11 #
)11# $
{22 	
return33 
View33 
(33 
$str33 $
)33$ %
;33% &
}44 	
var66 
osbb66 
=66 
await66 
_osbbService66 %
.66% &
GetById66& -
(66- .
userOsbb66. 6
.666 7
OsbbId667 =
.66= >
Value66> C
)66C D
;66D E
return88 
View88 
(88 
_mapper88 
.88 
Map88 
<88  
Osbb88  $
,88$ %
OsbbViewModel88& 3
>883 4
(884 5
osbb885 9
)889 :
)88: ;
;88; <
}99 
[;; 
	Authorize;; 
(;; 
Roles;; 
=;; 
$str;; !
);;! "
];;" #
[<< 
HttpPost<< 
]<< 
public== 

async== 
Task== 
<== 
IActionResult== #
>==# $

CreateOsbb==% /
(==/ 0
OsbbViewModel==0 =
obj==> A
)==A B
{>> 
await?? 
_osbbService?? 
.?? 
Add?? 
(?? 
_mapper?? &
.??& '
Map??' *
<??* +
OsbbViewModel??+ 8
,??8 9
Osbb??: >
>??> ?
(??? @
obj??@ C
)??C D
)??D E
;??E F
var@@ 
usr@@ 
=@@ 
await@@ 
_userManager@@ $
.@@$ %
GetUserAsync@@% 1
(@@1 2
HttpContext@@2 =
.@@= >
User@@> B
)@@B C
;@@C D
varAA 
userEntAA 
=AA 
awaitAA 
_userManagerAA (
.AA( )
FindByEmailAsyncAA) 9
(AA9 :
usrAA: =
.AA= >
EmailAA> C
)AAC D
;AAD E
varBB 
osbbTBB 
=BB 
awaitBB 
_osbbServiceBB &
.BB& '
GetAllBB' -
(BB- .
)BB. /
;BB/ 0
varCC 
osbbCC 
=CC 
osbbTCC 
.CC 
WhereCC 
(CC 
xCC  
=>CC! #
xCC$ %
.CC% &
NameCC& *
==CC+ -
objCC. 1
.CC1 2
NameCC2 6
)CC6 7
.CC7 8
FirstCC8 =
(CC= >
)CC> ?
;CC? @
userEntEE 
.EE 
OsbbIdEE 
=EE 
osbbEE 
.EE 
OsbbIdEE $
;EE$ %
userEntFF 
.FF 
OsbbFF 
=FF 
osbbFF 
;FF 
awaitGG 
_userManagerGG 
.GG 
UpdateAsyncGG &
(GG& '
userEntGG' .
)GG. /
;GG/ 0
returnHH 
RedirectToActionHH 
(HH  
$strHH  &
)HH& '
;HH' (
}II 
[KK 
	AuthorizeKK 
(KK 
RolesKK 
=KK 
$strKK !
)KK! "
]KK" #
publicLL 

IActionResultLL  
AnnouncementCreationLL -
(LL- .
)LL. /
{MM 
returnNN 
ViewNN 
(NN 
)NN 
;NN 
}OO 
[QQ 
	AuthorizeQQ 
(QQ 
RolesQQ 
=QQ 
$strQQ !
)QQ! "
]QQ" #
publicRR 

asyncRR 
TaskRR 
<RR 
IActionResultRR #
>RR# $
ShowAnnouncementsRR% 6
(RR6 7
)RR7 8
{SS 
varTT 
usrTT 
=TT 
awaitTT #
_applicationUserServiceTT /
.TT/ 0
GetUserManagerTT0 >
(TT> ?
)TT? @
.TT@ A
GetUserAsyncTTA M
(TTM N
HttpContextTTN Y
.TTY Z
UserTTZ ^
)TT^ _
;TT_ `
varUU 
getAnnouncementsUU 
=UU 
awaitUU $ 
_announcementServiceUU% 9
.UU9 :
GetAllUU: @
(UU@ A
)UUA B
;UUB C
varVV 
announcementsVV 
=VV 
getAnnouncementsVV ,
.VV, -
WhereVV- 2
(VV2 3
xVV3 4
=>VV5 7
xVV8 9
.VV9 :
OsbbIdVV: @
==VVA C
usrVVD G
.VVG H
OsbbIdVVH N
)VVN O
;VVO P
ifXX 

(XX 
announcementsXX 
.XX 
IsNullOrEmptyXX '
(XX' (
)XX( )
)XX) *
{YY 	
returnZZ 
ViewZZ 
(ZZ 
$strZZ )
)ZZ) *
;ZZ* +
}[[ 	
return\\ 
View\\ 
(\\ 
announcements\\ !
.]] 
Select]] 
(]] 
x]] 
=>]] 
_mapper]]  
.]]  !
Map]]! $
<]]$ %
Announcement]]% 1
,]]1 2!
AnnouncementViewModel]]3 H
>]]H I
(]]I J
x]]J K
)]]K L
)]]L M
.]]M N
ToList]]N T
(]]T U
)]]U V
)]]V W
;]]W X
}^^ 
[`` 
	Authorize`` 
(`` 
Roles`` 
=`` 
$str`` !
)``! "
]``" #
[aa 
HttpPostaa 
]aa 
publicbb 

asyncbb 
Taskbb 
<bb 
IActionResultbb #
>bb# $
CreateAnnouncementbb% 7
(bb7 8!
AnnouncementViewModelbb8 M
objbbN Q
)bbQ R
{cc 
vardd 
usrdd 
=dd 
awaitdd #
_applicationUserServicedd /
.dd/ 0
GetUserManagerdd0 >
(dd> ?
)dd? @
.dd@ A
GetUserAsyncddA M
(ddM N
HttpContextddN Y
.ddY Z
UserddZ ^
)dd^ _
;dd_ `
varee 
osbbTee 
=ee 
awaitee 
_osbbServiceee &
.ee& '
GetAllee' -
(ee- .
)ee. /
;ee/ 0
varff 
osbbff 
=ff 
osbbTff 
.ff 
Whereff 
(ff 
xff  
=>ff! #
xff$ %
.ff% &
OsbbIdff& ,
==ff- /
usrff0 3
.ff3 4
OsbbIdff4 :
)ff: ;
.ff; <
Firstff< A
(ffA B
)ffB C
;ffC D
objhh 
.hh 
OsbbIdhh 
=hh 
osbbhh 
.hh 
OsbbIdhh  
;hh  !
objii 
.ii 
UserIdii 
=ii 
usrii 
.ii 
Idii 
;ii 
objjj 
.jj 
Datejj 
=jj 
DateTimejj 
.jj 
Nowjj 
;jj  
awaitmm  
_announcementServicemm "
.mm" #
Addmm# &
(mm& '
_mappermm' .
.mm. /
Mapmm/ 2
<mm2 3!
AnnouncementViewModelmm3 H
,mmH I
AnnouncementmmJ V
>mmV W
(mmW X
objmmX [
)mm[ \
)mm\ ]
;mm] ^
returnoo 
RedirectToActionoo 
(oo  
$stroo  3
)oo3 4
;oo4 5
}pp 
}qq úA
TC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Controllers\ProposalController.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Controllers "
;" #
public 
class 
ProposalController 
:  !

Controller" ,
{ 
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
UserManager  
<  !
ApplicationUser! 0
>0 1
_userManager2 >
;> ?
private 
readonly 
IOsbbService !
_osbbService" .
;. /
private 
readonly 
IProposalService %
_proposalService& 6
;6 7
private 
readonly #
IApplicationUserService ,#
_applicationUserService- D
;D E
public 

ProposalController 
( 
IMapper %
mapper& ,
,, -
UserManager 
< 
ApplicationUser #
># $
userManager% 0
,0 1
IOsbbService 
osbbService  
,  !
IProposalService 
proposalService (
,( )#
IApplicationUserService "
applicationUserService  6
)6 7
{ 
_mapper 
= 
mapper 
; 
_userManager 
= 
userManager "
;" #
_osbbService 
= 
osbbService "
;" #
_proposalService 
= 
proposalService *
;* +#
_applicationUserService 
=  !"
applicationUserService" 8
;8 9
}   
["" 
	Authorize"" 
("" 
Roles"" 
="" 
$str"" !
)""! "
]""" #
public## 

async## 
Task## 
<## 
IActionResult## #
>### $
ShowProposalsToHead##% 8
(##8 9
)##9 :
{$$ 
var%% 
usr%% 
=%% 
await%% #
_applicationUserService%% /
.%%/ 0
GetUserManager%%0 >
(%%> ?
)%%? @
.%%@ A
GetUserAsync%%A M
(%%M N
HttpContext%%N Y
.%%Y Z
User%%Z ^
)%%^ _
;%%_ `
var&& 
getProposals&& 
=&& 
await&&  
_proposalService&&! 1
.&&1 2
GetAll&&2 8
(&&8 9
)&&9 :
;&&: ;
var'' 
	proposals'' 
='' 
getProposals'' $
.''$ %
Where''% *
(''* +
x''+ ,
=>''- /
x''0 1
.''1 2
OsbbId''2 8
==''9 ;
usr''< ?
.''? @
OsbbId''@ F
)''F G
;''G H
if)) 

()) 
	proposals)) 
.)) 
IsNullOrEmpty)) #
())# $
)))$ %
)))% &
{** 	
return++ 
View++ 
(++ 
$str++ +
)+++ ,
;++, -
},, 	
return.. 
View.. 
(.. 
$str.. %
,..% &
	proposals..' 0
.// 
Select// 
(// 
x// 
=>// 
_mapper//  
.//  !
Map//! $
<//$ %
Proposal//% -
,//- .
ProposalViewModel/// @
>//@ A
(//A B
x//B C
)//C D
)//D E
.//E F
ToList//F L
(//L M
)//M N
)//N O
;//O P
}00 
[22 
	Authorize22 
(22 
Roles22 
=22 
$str22 !
)22! "
]22" #
public33 

async33 
Task33 
<33 
IActionResult33 #
>33# $$
ShowProposalsToResidents33% =
(33= >
)33> ?
{44 
var55 
usr55 
=55 
await55 #
_applicationUserService55 /
.55/ 0
GetUserManager550 >
(55> ?
)55? @
.55@ A
GetUserAsync55A M
(55M N
HttpContext55N Y
.55Y Z
User55Z ^
)55^ _
;55_ `
var66 
getProposals66 
=66 
await66  
_proposalService66! 1
.661 2
GetAll662 8
(668 9
)669 :
;66: ;
var77 
	proposals77 
=77 
getProposals77 $
.77$ %
Where77% *
(77* +
x77+ ,
=>77- /
x770 1
.771 2
OsbbId772 8
==779 ;
usr77< ?
.77? @
OsbbId77@ F
)77F G
;77G H
if99 

(99 
	proposals99 
.99 
IsNullOrEmpty99 #
(99# $
)99$ %
)99% &
{:: 	
return;; 
View;; 
(;; 
$str;; 0
);;0 1
;;;1 2
}<< 	
return>> 
View>> 
(>> 
$str>> *
,>>* +
	proposals>>, 5
.?? 
Select?? 
(?? 
x?? 
=>?? 
_mapper??  
.??  !
Map??! $
<??$ %
Proposal??% -
,??- .
ProposalViewModel??/ @
>??@ A
(??A B
x??B C
)??C D
)??D E
.??E F
ToList??F L
(??L M
)??M N
)??N O
;??O P
}@@ 
[BB 
	AuthorizeBB 
(BB 
RolesBB 
=BB 
$strBB !
)BB! "
]BB" #
[CC 
HttpGetCC 
]CC 
publicDD 

IActionResultDD 
CreateProposalDD '
(DD' (
)DD( )
{EE 
returnFF 
ViewFF 
(FF 
$strFF $
)FF$ %
;FF% &
}GG 
[II 
	AuthorizeII 
(II 
RolesII 
=II 
$strII !
)II! "
]II" #
[JJ 
HttpPostJJ 
]JJ 
publicKK 

asyncKK 
TaskKK 
<KK 
IActionResultKK #
>KK# $
CreateProposalKK% 3
(KK3 4
ProposalViewModelKK4 E
proposalKKF N
)KKN O
{LL 
varMM 
usrMM 
=MM 
awaitMM #
_applicationUserServiceMM /
.MM/ 0
GetUserManagerMM0 >
(MM> ?
)MM? @
.MM@ A
GetUserAsyncMMA M
(MMM N
HttpContextMMN Y
.MMY Z
UserMMZ ^
)MM^ _
;MM_ `
varNN 
osbbTNN 
=NN 
awaitNN 
_osbbServiceNN &
.NN& '
GetAllNN' -
(NN- .
)NN. /
;NN/ 0
varOO 
osbbOO 
=OO 
osbbTOO 
.OO 
WhereOO 
(OO 
xOO  
=>OO! #
xOO$ %
.OO% &
OsbbIdOO& ,
==OO- /
usrOO0 3
.OO3 4
OsbbIdOO4 :
)OO: ;
.OO; <
FirstOO< A
(OOA B
)OOB C
;OOC D
proposalQQ 
.QQ 
OsbbIdQQ 
=QQ 
osbbQQ 
.QQ 
OsbbIdQQ %
;QQ% &
proposalRR 
.RR 
UserIdRR 
=RR 
usrRR 
.RR 
IdRR  
;RR  !
proposalSS 
.SS 
DateSS 
=SS 
DateTimeSS  
.SS  !
NowSS! $
;SS$ %
awaitVV 
_proposalServiceVV 
.VV 
AddVV "
(VV" #
_mapperVV# *
.VV* +
MapVV+ .
<VV. /
ProposalViewModelVV/ @
,VV@ A
ProposalVVB J
>VVJ K
(VVK L
proposalVVL T
)VVT U
)VVU V
;VVV W
returnXX 
RedirectToActionXX 
(XX  
$strXX  :
)XX: ;
;XX; <
}YY 
}ZZ è=
TC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Controllers\ResidentController.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Controllers "
;" #
public 
class 
ResidentController 
:  !

Controller" ,
{ 
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
UserManager  
<  !
ApplicationUser! 0
>0 1
_userManager2 >
;> ?
private 
readonly 
IOsbbService !
_osbbService" .
;. /
private 
readonly  
IAnnouncementService ) 
_announcementService* >
;> ?
private 
readonly #
IApplicationUserService ,#
_applicationUserService- D
;D E
public 

ResidentController 
( 
IMapper %
mapper& ,
,, -
UserManager 
< 
ApplicationUser #
># $
userManager% 0
,0 1
IOsbbService 
osbbService  
,  ! 
IAnnouncementService 
announcementService 0
,0 1#
IApplicationUserService "
applicationUserService  6
)6 7
{ 
_mapper 
= 
mapper 
; 
_userManager 
= 
userManager "
;" #
_osbbService 
= 
osbbService "
;" # 
_announcementService 
= 
announcementService 2
;2 3#
_applicationUserService 
=  !"
applicationUserService" 8
;8 9
}   
["" 
	Authorize"" 
("" 
Roles"" 
="" 
$str"" !
)""! "
]""" #
public## 

IActionResult## 
Resident## !
(##! "
)##" #
{$$ 
return%% 
View%% 
(%% 
)%% 
;%% 
}&& 
[(( 
	Authorize(( 
((( 
Roles(( 
=(( 
$str(( !
)((! "
]((" #
public)) 

async)) 
Task)) 
<)) 
IActionResult)) #
>))# $
Osbb))% )
())) *
)))* +
{** 
var++ 
usr++ 
=++ 
await++ 
_userManager++ $
.++$ %
GetUserAsync++% 1
(++1 2
HttpContext++2 =
.++= >
User++> B
)++B C
;++C D
var,, 
userOsbb,, 
=,, 
await,, 
_userManager,, )
.,,) *
FindByEmailAsync,,* :
(,,: ;
usr,,; >
.,,> ?
Email,,? D
),,D E
;,,E F
if-- 

(-- 
userOsbb-- 
.-- 
OsbbId-- 
==-- 
null-- #
)--# $
{.. 	
return// 
View// 
(// 
$str// &
)//& '
;//' (
}00 	
var11 
osbb11 
=11 
await11 
_osbbService11 %
.11% &
GetById11& -
(11- .
userOsbb11. 6
.116 7
OsbbId117 =
.11= >
Value11> C
)11C D
;11D E
return22 
View22 
(22 
_mapper22 
.22 
Map22 
<22  
Osbb22  $
,22$ %
OsbbViewModel22& 3
>223 4
(224 5
osbb225 9
)229 :
)22: ;
;22; <
}33 
[55 
	Authorize55 
(55 
Roles55 
=55 
$str55 !
)55! "
]55" #
[66 
HttpPost66 
]66 
public77 

async77 
Task77 
<77 
IActionResult77 #
>77# $
ConnectToOsbb77% 2
(772 3
NameRecordViewModel773 F
osbbName77G O
)77O P
{88 
var99 
osbbT99 
=99 
await99 
_osbbService99 &
.99& '
GetAll99' -
(99- .
)99. /
;99/ 0
var:: 
osbb:: 
=:: 
osbbT:: 
.:: 
Where:: 
(:: 
x::  
=>::! #
x::$ %
.::% &
Name::& *
==::+ -
osbbName::. 6
.::6 7
Name::7 ;
)::; <
.::< =
First::= B
(::B C
)::C D
;::D E
var<< 
usr<< 
=<< 
await<< 
_userManager<< $
.<<$ %
GetUserAsync<<% 1
(<<1 2
HttpContext<<2 =
.<<= >
User<<> B
)<<B C
;<<C D
osbb>> 
.>> 
	Residents>> 
.>> 
Add>> 
(>> 
usr>> 
)>> 
;>>  
await?? 
_osbbService?? 
.?? 
Update?? !
(??! "
osbb??" &
)??& '
;??' (
usrAA 
.AA 
OsbbIdAA 
=AA 
osbbAA 
.AA 
OsbbIdAA  
;AA  !
usrBB 
.BB 
OsbbBB 
=BB 
osbbBB 
;BB 
awaitCC 
_userManagerCC 
.CC 
UpdateAsyncCC &
(CC& '
usrCC' *
)CC* +
;CC+ ,
returnEE 
RedirectToActionEE 
(EE  
$strEE  &
)EE& '
;EE' (
}FF 
[HH 
	AuthorizeHH 
(HH 
RolesHH 
=HH 
$strHH !
)HH! "
]HH" #
publicII 

asyncII 
TaskII 
<II 
IActionResultII #
>II# $
ShowAnnouncementsII% 6
(II6 7
)II7 8
{JJ 
varKK 
usrKK 
=KK 
awaitKK #
_applicationUserServiceKK /
.KK/ 0
GetUserManagerKK0 >
(KK> ?
)KK? @
.KK@ A
GetUserAsyncKKA M
(KKM N
HttpContextKKN Y
.KKY Z
UserKKZ ^
)KK^ _
;KK_ `
varLL 
getAnnouncementsLL 
=LL 
awaitLL $ 
_announcementServiceLL% 9
.LL9 :
GetAllLL: @
(LL@ A
)LLA B
;LLB C
varMM 
announcementsMM 
=MM 
getAnnouncementsMM ,
.MM, -
WhereMM- 2
(MM2 3
xMM3 4
=>MM5 7
xMM8 9
.MM9 :
OsbbIdMM: @
==MMA C
usrMMD G
.MMG H
OsbbIdMMH N
)MMN O
;MMO P
ifOO 

(OO 
announcementsOO 
.OO 
IsNullOrEmptyOO '
(OO' (
)OO( )
)OO) *
{PP 	
returnQQ 
ViewQQ 
(QQ 
$strQQ )
)QQ) *
;QQ* +
}RR 	
returnSS 
ViewSS 
(SS 
announcementsSS !
.TT 
SelectTT 
(TT 
xTT 
=>TT 
_mapperTT  
.TT  !
MapTT! $
<TT$ %
AnnouncementTT% 1
,TT1 2!
AnnouncementViewModelTT3 H
>TTH I
(TTI J
xTTJ K
)TTK L
)TTL M
.TTM N
ToListTTN T
(TTT U
)TTU V
)TTV W
;TTW X
}UU 
}VV ‰T
RC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Controllers\TariffController.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Controllers "
;" #
public 
class 
TariffController 
: 

Controller  *
{ 
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
UserManager  
<  !
ApplicationUser! 0
>0 1
_userManager2 >
;> ?
private 
readonly 
IOsbbService !
_osbbService" .
;. /
private 
readonly 
ITariffService #
_tariffService$ 2
;2 3
private 
readonly #
IApplicationUserService ,#
_applicationUserService- D
;D E
public 

TariffController 
( 
IMapper #
mapper$ *
,* +
UserManager 
< 
ApplicationUser #
># $
userManager% 0
,0 1
IOsbbService 
osbbService  
,  !
ITariffService 
tariffService $
,$ %#
IApplicationUserService "
applicationUserService  6
)6 7
{ 
_mapper 
= 
mapper 
; 
_userManager 
= 
userManager "
;" #
_osbbService 
= 
osbbService "
;" #
_tariffService 
= 
tariffService &
;& '#
_applicationUserService 
=  !"
applicationUserService" 8
;8 9
}   
["" 
	Authorize"" 
("" 
Roles"" 
="" 
$str"" !
)""! "
]""" #
public## 

async## 
Task## 
<## 
IActionResult## #
>### $
ShowTariffsToHead##% 6
(##6 7
)##7 8
{$$ 
var%% 
usr%% 
=%% 
await%% #
_applicationUserService%% /
.%%/ 0
GetUserManager%%0 >
(%%> ?
)%%? @
.%%@ A
GetUserAsync%%A M
(%%M N
HttpContext%%N Y
.%%Y Z
User%%Z ^
)%%^ _
;%%_ `
var&& 

getTariffs&& 
=&& 
await&& 
_tariffService&& -
.&&- .
GetAll&&. 4
(&&4 5
)&&5 6
;&&6 7
var'' 
tariffs'' 
='' 

getTariffs''  
.''  !
Where''! &
(''& '
x''' (
=>'') +
x'', -
.''- .
OsbbId''. 4
==''5 7
usr''8 ;
.''; <
OsbbId''< B
)''B C
;''C D
if)) 

()) 
tariffs)) 
.)) 
IsNullOrEmpty)) !
())! "
)))" #
)))# $
{** 	
return++ 
View++ 
(++ 
$str++ )
)++) *
;++* +
},, 	
return.. 
View.. 
(.. 
$str.. #
,..# $
tariffs..% ,
.// 
Select// 
(// 
x// 
=>// 
_mapper//  
.//  !
Map//! $
<//$ %
Tariff//% +
,//+ ,
TariffViewModel//- <
>//< =
(//= >
x//> ?
)//? @
)//@ A
.//A B
ToList//B H
(//H I
)//I J
)//J K
;//K L
}00 
[22 
	Authorize22 
(22 
Roles22 
=22 
$str22 !
)22! "
]22" #
public33 

async33 
Task33 
<33 
IActionResult33 #
>33# $"
ShowTariffsToResidents33% ;
(33; <
)33< =
{44 
var55 
usr55 
=55 
await55 #
_applicationUserService55 /
.55/ 0
GetUserManager550 >
(55> ?
)55? @
.55@ A
GetUserAsync55A M
(55M N
HttpContext55N Y
.55Y Z
User55Z ^
)55^ _
;55_ `
var66 

getTariffs66 
=66 
await66 
_tariffService66 -
.66- .
GetAll66. 4
(664 5
)665 6
;666 7
var77 
tariffs77 
=77 

getTariffs77  
.77  !
Where77! &
(77& '
x77' (
=>77) +
x77, -
.77- .
OsbbId77. 4
==775 7
usr778 ;
.77; <
OsbbId77< B
)77B C
.88 
Where88 
(88 
x88 
=>88 
x88 
.88 
UserId88  
==88! #
usr88$ '
.88' (
Id88( *
)88* +
;88+ ,
if:: 

(:: 
tariffs:: 
.:: 
IsNullOrEmpty:: !
(::! "
)::" #
)::# $
{;; 	
return<< 
View<< 
(<< 
$str<< .
)<<. /
;<</ 0
}== 	
return?? 
View?? 
(?? 
$str?? (
,??( )
tariffs??* 1
.@@ 
Select@@ 
(@@ 
x@@ 
=>@@ 
_mapper@@  
.@@  !
Map@@! $
<@@$ %
Tariff@@% +
,@@+ ,
TariffViewModel@@- <
>@@< =
(@@= >
x@@> ?
)@@? @
)@@@ A
.@@A B
ToList@@B H
(@@H I
)@@I J
)@@J K
;@@K L
}AA 
[CC 
	AuthorizeCC 
(CC 
RolesCC 
=CC 
$strCC !
)CC! "
]CC" #
[DD 
HttpGetDD 
]DD 
publicEE 

asyncEE 
TaskEE 
<EE 
IActionResultEE #
>EE# $
CreateTariffEE% 1
(EE1 2
)EE2 3
{FF 
varGG 
usrGG 
=GG 
awaitGG #
_applicationUserServiceGG /
.GG/ 0
GetUserManagerGG0 >
(GG> ?
)GG? @
.GG@ A
GetUserAsyncGGA M
(GGM N
HttpContextGGN Y
.GGY Z
UserGGZ ^
)GG^ _
;GG_ `
varHH 
osbbTHH 
=HH 
awaitHH 
_osbbServiceHH &
.HH& '
GetAllHH' -
(HH- .
)HH. /
;HH/ 0
varII 
osbbII 
=II 
osbbTII 
.II 
WhereII 
(II 
xII  
=>II! #
xII$ %
.II% &
OsbbIdII& ,
==II- /
usrII0 3
.II3 4
OsbbIdII4 :
)II: ;
.II; <
FirstII< A
(IIA B
)IIB C
;IIC D
varKK 
usersKK 
=KK 
awaitKK #
_applicationUserServiceKK 1
.KK1 2
GetAllKK2 8
(KK8 9
)KK9 :
;KK: ;
varLL 
listLL 
=LL 
newLL 
ListLL 
<LL 
SelectListItemLL *
>LL* +
(LL+ ,
)LL, -
;LL- .
foreachMM 
(MM 
varMM 
uMM 
inMM 
usersMM 
.MM  
WhereMM  %
(MM% &
xMM& '
=>MM( *
xMM+ ,
.MM, -
OsbbIdMM- 3
==MM4 6
osbbMM7 ;
.MM; <
OsbbIdMM< B
)MMB C
)MMC D
{NN 	
listOO 
.OO 
AddOO 
(OO 
newOO 
SelectListItemOO '
{PP 
ValueQQ 
=QQ 
uQQ 
.QQ 
IdQQ 
.QQ 
ToStringQQ %
(QQ% &
)QQ& '
,QQ' (
TextQQ) -
=QQ. /
$"QQ0 2
{QQ2 3
uQQ3 4
.QQ4 5
SurnameQQ5 <
}QQ< =
$strQQ= >
{QQ> ?
uQQ? @
.QQ@ A
NameQQA E
}QQE F
"QQF G
}RR 
)RR 
;RR 
}SS 	
ViewBagUU 
.UU 
	UsersListUU 
=UU 
listUU  
;UU  !
returnVV 
ViewVV 
(VV 
$strVV "
)VV" #
;VV# $
}WW 
[YY 
	AuthorizeYY 
(YY 
RolesYY 
=YY 
$strYY !
)YY! "
]YY" #
[ZZ 
HttpPostZZ 
]ZZ 
public[[ 

async[[ 
Task[[ 
<[[ 
IActionResult[[ #
>[[# $
CreateTariff[[% 1
([[1 2$
TariffAndUserIdViewModel[[2 J
tariffAndUserId[[K Z
)[[Z [
{\\ 
var]] 
usr]] 
=]] 
await]] #
_applicationUserService]] /
.]]/ 0
GetById]]0 7
(]]7 8
Convert]]8 ?
.]]? @
ToInt32]]@ G
(]]G H
tariffAndUserId]]H W
.]]W X
UserId]]X ^
)]]^ _
)]]_ `
;]]` a
var^^ 
osbbT^^ 
=^^ 
await^^ 
_osbbService^^ &
.^^& '
GetAll^^' -
(^^- .
)^^. /
;^^/ 0
var__ 
osbb__ 
=__ 
osbbT__ 
.__ 
Where__ 
(__ 
x__  
=>__! #
x__$ %
.__% &
OsbbId__& ,
==__- /
usr__0 3
.__3 4
OsbbId__4 :
)__: ;
.__; <
First__< A
(__A B
)__B C
;__C D
tariffAndUserIdaa 
.aa 
Tariffaa 
.aa 
OsbbIdaa %
=aa& '
osbbaa( ,
.aa, -
OsbbIdaa- 3
;aa3 4
tariffAndUserIdbb 
.bb 
Tariffbb 
.bb 
UserIdbb %
=bb& '
usrbb( +
.bb+ ,
Idbb, .
;bb. /
awaitdd 
_tariffServicedd 
.dd 
Adddd  
(dd  !
_mapperdd! (
.dd( )
Mapdd) ,
<dd, -
TariffViewModeldd- <
,dd< =
Tariffdd> D
>ddD E
(ddE F
tariffAndUserIdddF U
.ddU V
TariffddV \
)dd\ ]
)dd] ^
;dd^ _
returnff 
RedirectToActionff 
(ff  
$strff  3
)ff3 4
;ff4 5
}gg 
}hh πy
RC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Controllers\VotingController.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Controllers "
;" #
public 
class 
VotingController 
: 

Controller  *
{ 
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
UserManager  
<  !
ApplicationUser! 0
>0 1
_userManager2 >
;> ?
private 
readonly 
IOsbbService !
_osbbService" .
;. /
private 
readonly 
IVotingService #
_votingService$ 2
;2 3
private 
readonly #
IApplicationUserService ,#
_applicationUserService- D
;D E
public 

VotingController 
( 
IMapper #
mapper$ *
,* +
UserManager 
< 
ApplicationUser #
># $
userManager% 0
,0 1
IOsbbService 
osbbService  
,  !
IVotingService 
votingService $
,$ %#
IApplicationUserService "
applicationUserService  6
)6 7
{ 
_mapper 
= 
mapper 
; 
_userManager 
= 
userManager "
;" #
_osbbService 
= 
osbbService "
;" #
_votingService 
= 
votingService &
;& '#
_applicationUserService   
=    !"
applicationUserService  " 8
;  8 9
}!! 
[## 
	Authorize## 
(## 
Roles## 
=## 
$str## !
)##! "
]##" #
public$$ 

async$$ 
Task$$ 
<$$ 
IActionResult$$ #
>$$# $
ShowVotingToHead$$% 5
($$5 6
)$$6 7
{%% 
var&& 
usr&& 
=&& 
await&& #
_applicationUserService&& /
.&&/ 0
GetUserManager&&0 >
(&&> ?
)&&? @
.&&@ A
GetUserAsync&&A M
(&&M N
HttpContext&&N Y
.&&Y Z
User&&Z ^
)&&^ _
;&&_ `
var'' 
getPolls'' 
='' 
await'' 
_votingService'' +
.''+ ,
ShowActiveOsbbPolls'', ?
(''? @
usr''@ C
.''C D
OsbbId''D J
.''J K
Value''K P
)''P Q
;''Q R
if)) 

()) 
getPolls)) 
.)) 
IsNullOrEmpty)) "
())" #
)))# $
)))$ %
{** 	
return++ 
View++ 
(++ 
$str++ '
)++' (
;++( )
},, 	
return.. 
View.. 
(.. 
$str.. !
,..! "
getPolls..# +
.// 
Select// 
(// 
x// 
=>// 
_mapper//  
.//  !
Map//! $
<//$ %
Poll//% )
,//) *
PollViewModel//+ 8
>//8 9
(//9 :
x//: ;
)//; <
)//< =
.//= >
ToList//> D
(//D E
)//E F
)//F G
;//G H
}00 
[22 
	Authorize22 
(22 
Roles22 
=22 
$str22 !
)22! "
]22" #
public33 

async33 
Task33 
<33 
IActionResult33 #
>33# $!
ShowVotingToResidents33% :
(33: ;
)33; <
{44 
var55 
usr55 
=55 
await55 #
_applicationUserService55 /
.55/ 0
GetUserManager550 >
(55> ?
)55? @
.55@ A
GetUserAsync55A M
(55M N
HttpContext55N Y
.55Y Z
User55Z ^
)55^ _
;55_ `
var66 
getPolls66 
=66 
await66 
_votingService66 +
.66+ ,
ShowActiveOsbbPolls66, ?
(66? @
usr66@ C
.66C D
OsbbId66D J
.66J K
Value66K P
)66P Q
;66Q R
if88 

(88 
getPolls88 
.88 
IsNullOrEmpty88 "
(88" #
)88# $
)88$ %
{99 	
return:: 
View:: 
(:: 
$str:: ,
)::, -
;::- .
};; 	
return== 
View== 
(== 
$str== &
,==& '
getPolls==( 0
.>> 
Select>> 
(>> 
x>> 
=>>> 
_mapper>>  
.>>  !
Map>>! $
<>>$ %
Poll>>% )
,>>) *
PollViewModel>>+ 8
>>>8 9
(>>9 :
x>>: ;
)>>; <
)>>< =
.>>= >
ToList>>> D
(>>D E
)>>E F
)>>F G
;>>G H
}?? 
[AA 
	AuthorizeAA 
(AA 
RolesAA 
=AA 
$strAA !
)AA! "
]AA" #
[BB 
HttpGetBB 
]BB 
publicCC 

asyncCC 
TaskCC 
<CC 
IActionResultCC #
>CC# $

CreatePollCC% /
(CC/ 0
)CC0 1
{DD 
returnEE 
ViewEE 
(EE 
$strEE  
)EE  !
;EE! "
}FF 
[HH 
	AuthorizeHH 
(HH 
RolesHH 
=HH 
$strHH !
)HH! "
]HH" #
[II 
HttpPostII 
]II 
publicJJ 

asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ #
>JJ# $

CreatePollJJ% /
(JJ/ 0'
PollWithCandidatesViewModelJJ0 K
pollJJL P
)JJP Q
{KK 
varLL 
pollNameLL 
=LL 
pollLL 
.LL 
NameLL  
;LL  !
varMM 
pollDescMM 
=MM 
pollMM 
.MM 
DescriptionMM '
;MM' (
varNN 
listOfCandidatesNN 
=NN 
pollNN #
.NN# $
	CandidateNN$ -
.OO 
SelectOO 
(OO 
xOO 
=>OO 
_mapperOO  
.OO  !
MapOO! $
<OO$ %"
PollCandidateViewModelOO% ;
,OO; <
PollCandidateOO= J
>OOJ K
(OOK L
xOOL M
)OOM N
)OON O
.PP 
ToListPP 
(PP 
)PP 
;PP 
varQQ 
	readyPollQQ 
=QQ 
newQQ 
PollQQ  
(QQ  !
pollNameQQ! )
,QQ) *
pollDescQQ+ 3
,QQ3 4
listOfCandidatesQQ5 E
)QQE F
;QQF G
varSS 
usrSS 
=SS 
awaitSS #
_applicationUserServiceSS /
.SS/ 0
GetUserManagerSS0 >
(SS> ?
)SS? @
.SS@ A
GetUserAsyncSSA M
(SSM N
HttpContextSSN Y
.SSY Z
UserSSZ ^
)SS^ _
;SS_ `
	readyPollUU 
.UU 
DateUU 
=UU 
DateTimeUU !
.UU! "
NowUU" %
;UU% &
	readyPollVV 
.VV 
UserIdVV 
=VV 
usrVV 
.VV 
IdVV !
;VV! "
	readyPollWW 
.WW 
OsbbIdWW 
=WW 
usrWW 
.WW 
OsbbIdWW %
.WW% &
ValueWW& +
;WW+ ,
awaitYY 
_votingServiceYY 
.YY 

CreatePollYY '
(YY' (
	readyPollYY( 1
)YY1 2
;YY2 3
return[[ 
RedirectToAction[[ 
([[  
$str[[  2
)[[2 3
;[[3 4
}\\ 
[^^ 
	Authorize^^ 
(^^ 
Roles^^ 
=^^ 
$str^^ !
)^^! "
]^^" #
[__ 
HttpGet__ 
]__ 
public`` 

async`` 
Task`` 
<`` 
IActionResult`` #
>``# $
HeadVote``% -
(``- .
string``. 4
pollId``5 ;
)``; <
{aa 
varbb 
pollbb 
=bb 
awaitbb 
_votingServicebb '
.bb' (
GetPollByIdbb( 3
(bb3 4
Convertbb4 ;
.bb; <
ToInt32bb< C
(bbC D
pollIdbbD J
)bbJ K
)bbK L
;bbL M
ViewBagcc 
.cc 
PollNamecc 
=cc 
pollcc 
.cc  
Namecc  $
;cc$ %
ViewBagdd 
.dd 
PollDescriptiondd 
=dd  !
polldd" &
.dd& '
Descriptiondd' 2
;dd2 3
varee 
pollCandidatesee 
=ee 
awaitee "
_votingServiceee# 1
.ee1 2)
GetManyPollCandidatesByPollIdee2 O
(eeO P
polleeP T
.eeT U
IdeeU W
)eeW X
;eeX Y
ViewBagff 
.ff  
PollCandidatesIdNameff $
=ff% &
pollCandidatesff' 5
.ff5 6
Selectff6 <
(ff< =
xff= >
=>ff? A
(ffB C
xffC D
.ffD E
IdffE G
,ffG H
xffI J
.ffJ K
NameffK O
)ffO P
)ffP Q
.ffQ R
ToListffR X
(ffX Y
)ffY Z
;ffZ [
returnhh 
Viewhh 
(hh 
$strhh (
)hh( )
;hh) *
}ii 
[kk 
	Authorizekk 
(kk 
Roleskk 
=kk 
$strkk !
)kk! "
]kk" #
[ll 
HttpGetll 
]ll 
publicmm 

asyncmm 
Taskmm 
<mm 
IActionResultmm #
>mm# $
ResidentVotemm% 1
(mm1 2
stringmm2 8
pollIdmm9 ?
)mm? @
{nn 
varoo 
polloo 
=oo 
awaitoo 
_votingServiceoo '
.oo' (
GetPollByIdoo( 3
(oo3 4
Convertoo4 ;
.oo; <
ToInt32oo< C
(ooC D
pollIdooD J
)ooJ K
)ooK L
;ooL M
ViewBagpp 
.pp 
PollNamepp 
=pp 
pollpp 
.pp  
Namepp  $
;pp$ %
ViewBagqq 
.qq 
PollDescriptionqq 
=qq  !
pollqq" &
.qq& '
Descriptionqq' 2
;qq2 3
varrr 
pollCandidatesrr 
=rr 
awaitrr "
_votingServicerr# 1
.rr1 2)
GetManyPollCandidatesByPollIdrr2 O
(rrO P
pollrrP T
.rrT U
IdrrU W
)rrW X
;rrX Y
ViewBagss 
.ss  
PollCandidatesIdNamess $
=ss% &
pollCandidatesss' 5
.ss5 6
Selectss6 <
(ss< =
xss= >
=>ss? A
(ssB C
xssC D
.ssD E
IdssE G
,ssG H
xssI J
.ssJ K
NamessK O
)ssO P
)ssP Q
.ssQ R
ToListssR X
(ssX Y
)ssY Z
;ssZ [
returnuu 
Viewuu 
(uu 
$struu ,
)uu, -
;uu- .
}vv 
[xx 
	Authorizexx 
(xx 
Rolesxx 
=xx 
$strxx !
)xx! "
]xx" #
[yy 
HttpPostyy 
]yy 
publiczz 

asynczz 
Taskzz 
<zz 
IActionResultzz #
>zz# $ 
HeadVoteForCandidatezz% 9
(zz9 :
stringzz: @
pollCandidateIdzzA P
)zzP Q
{{{ 
var|| 

pollCandId|| 
=|| 
Convert||  
.||  !
ToInt32||! (
(||( )
pollCandidateId||) 8
)||8 9
;||9 :
Console~~ 
.~~ 
	WriteLine~~ 
(~~ 
$"~~ 
$str~~ %
{~~% &

pollCandId~~& 0
}~~0 1
"~~1 2
)~~2 3
;~~3 4
var
ÄÄ 
usr
ÄÄ 
=
ÄÄ 
await
ÄÄ %
_applicationUserService
ÄÄ /
.
ÄÄ/ 0
GetUserManager
ÄÄ0 >
(
ÄÄ> ?
)
ÄÄ? @
.
ÄÄ@ A
GetUserAsync
ÄÄA M
(
ÄÄM N
HttpContext
ÄÄN Y
.
ÄÄY Z
User
ÄÄZ ^
)
ÄÄ^ _
;
ÄÄ_ `
var
ÇÇ 
pollCand
ÇÇ 
=
ÇÇ 
await
ÇÇ 
_votingService
ÇÇ +
.
ÇÇ+ ,"
GetPollCandidateById
ÇÇ, @
(
ÇÇ@ A

pollCandId
ÇÇA K
)
ÇÇK L
;
ÇÇL M
await
ÑÑ 
_votingService
ÑÑ 
.
ÑÑ 
VoteForCandidate
ÑÑ -
(
ÑÑ- .
usr
ÑÑ. 1
.
ÑÑ1 2
Id
ÑÑ2 4
,
ÑÑ4 5
pollCand
ÑÑ6 >
)
ÑÑ> ?
;
ÑÑ? @
return
ÜÜ 
RedirectToAction
ÜÜ 
(
ÜÜ  
$str
ÜÜ  2
)
ÜÜ2 3
;
ÜÜ3 4
}
áá 
[
ââ 
	Authorize
ââ 
(
ââ 
Roles
ââ 
=
ââ 
$str
ââ !
)
ââ! "
]
ââ" #
[
ää 
HttpPost
ää 
]
ää 
public
ãã 

async
ãã 
Task
ãã 
<
ãã 
IActionResult
ãã #
>
ãã# $&
ResidentVoteForCandidate
ãã% =
(
ãã= >
string
ãã> D
pollCandidateId
ããE T
)
ããT U
{
åå 
var
çç 

pollCandId
çç 
=
çç 
Convert
çç  
.
çç  !
ToInt32
çç! (
(
çç( )
pollCandidateId
çç) 8
)
çç8 9
;
çç9 :
Console
èè 
.
èè 
	WriteLine
èè 
(
èè 
$"
èè 
$str
èè %
{
èè% &

pollCandId
èè& 0
}
èè0 1
"
èè1 2
)
èè2 3
;
èè3 4
var
ëë 
usr
ëë 
=
ëë 
await
ëë %
_applicationUserService
ëë /
.
ëë/ 0
GetUserManager
ëë0 >
(
ëë> ?
)
ëë? @
.
ëë@ A
GetUserAsync
ëëA M
(
ëëM N
HttpContext
ëëN Y
.
ëëY Z
User
ëëZ ^
)
ëë^ _
;
ëë_ `
var
ìì 
pollCand
ìì 
=
ìì 
await
ìì 
_votingService
ìì +
.
ìì+ ,"
GetPollCandidateById
ìì, @
(
ìì@ A

pollCandId
ììA K
)
ììK L
;
ììL M
await
ïï 
_votingService
ïï 
.
ïï 
VoteForCandidate
ïï -
(
ïï- .
usr
ïï. 1
.
ïï1 2
Id
ïï2 4
,
ïï4 5
pollCand
ïï6 >
)
ïï> ?
;
ïï? @
return
óó 
RedirectToAction
óó 
(
óó  
$str
óó  7
)
óó7 8
;
óó8 9
}
òò 
}ôô ‹
hC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Migrations\20230530072201_InfrastructureMigration1.cs
	namespace 	
YourOSBB
 
. 
Web 
. 

Migrations !
{ 
public		 

partial		 
class		 $
InfrastructureMigration1		 1
:		2 3
	Migration		4 =
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str $
)$ %
;% &
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str (
)( )
;) *
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str (
)( )
;) *
migrationBuilder 
. 
	DropTable &
(& '
name 
: 
$str (
)( )
;) *
migrationBuilder   
.   
	DropTable   &
(  & '
name!! 
:!! 
$str!! '
)!!' (
;!!( )
migrationBuilder## 
.## 
	DropTable## &
(##& '
name$$ 
:$$ 
$str$$ (
)$$( )
;$$) *
migrationBuilder&& 
.&& 
	DropTable&& &
(&&& '
name'' 
:'' 
$str'' !
)''! "
;''" #
migrationBuilder)) 
.)) 
	DropTable)) &
())& '
name** 
:** 
$str**  
)**  !
;**! "
migrationBuilder,, 
.,, 
	DropTable,, &
(,,& '
name-- 
:-- 
$str-- 
)-- 
;--  
migrationBuilder// 
.// 
	DropTable// &
(//& '
name00 
:00 
$str00 #
)00# $
;00$ %
migrationBuilder22 
.22 
	DropTable22 &
(22& '
name33 
:33 
$str33 (
)33( )
;33) *
migrationBuilder55 
.55 
	DropTable55 &
(55& '
name66 
:66 
$str66 
)66 
;66 
}77 	
}88 
}99 ä
WC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Migrations\20230531083853_Initial.cs
	namespace 	
YourOSBB
 
. 
Web 
. 

Migrations !
{ 
public 

partial 
class 
Initial  
:! "
	Migration# ,
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
} 	
} 
} ‰c
XC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Migrations\20230531132818_Initial1.cs
	namespace 	
YourOSBB
 
. 
Web 
. 

Migrations !
{ 
public		 

partial		 
class		 
Initial1		 !
:		" #
	Migration		$ -
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
UserId 
= 
table "
." #
Column# )
<) *
int* -
>- .
(. /
type/ 3
:3 4
$str5 :
,: ;
nullable< D
:D E
falseF K
)K L
,L M
OsbbId 
= 
table "
." #
Column# )
<) *
int* -
>- .
(. /
type/ 3
:3 4
$str5 :
,: ;
nullable< D
:D E
falseF K
)K L
,L M
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= L
,L M
nullableN V
:V W
falseX ]
)] ^
,^ _
Date 
= 
table  
.  !
Column! '
<' (
DateTime( 0
>0 1
(1 2
type2 6
:6 7
$str8 C
,C D
nullableE M
:M N
falseO T
)T U
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% .
,. /
x0 1
=>2 4
x5 6
.6 7
Id7 9
)9 :
;: ;
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name   
:   
$str   %
,  % &
columns!! 
:!! 
table!! 
=>!! !
new!!" %
{"" 
Id## 
=## 
table## 
.## 
Column## %
<##% &
int##& )
>##) *
(##* +
type##+ /
:##/ 0
$str##1 6
,##6 7
nullable##8 @
:##@ A
false##B G
)##G H
.$$ 

Annotation$$ #
($$# $
$str$$$ 8
,$$8 9
$str$$: @
)$$@ A
,$$A B
PollId%% 
=%% 
table%% "
.%%" #
Column%%# )
<%%) *
int%%* -
>%%- .
(%%. /
type%%/ 3
:%%3 4
$str%%5 :
,%%: ;
nullable%%< D
:%%D E
false%%F K
)%%K L
,%%L M
Name&& 
=&& 
table&&  
.&&  !
Column&&! '
<&&' (
string&&( .
>&&. /
(&&/ 0
type&&0 4
:&&4 5
$str&&6 E
,&&E F
nullable&&G O
:&&O P
false&&Q V
)&&V W
}'' 
,'' 
constraints(( 
:(( 
table(( "
=>((# %
{)) 
table** 
.** 

PrimaryKey** $
(**$ %
$str**% 7
,**7 8
x**9 :
=>**; =
x**> ?
.**? @
Id**@ B
)**B C
;**C D
table++ 
.++ 

ForeignKey++ $
(++$ %
name,, 
:,, 
$str,, <
,,,< =
column-- 
:-- 
x--  !
=>--" $
x--% &
.--& '
PollId--' -
,--- .
principalTable.. &
:..& '
$str..( .
,... /
principalColumn// '
://' (
$str//) -
,//- .
onDelete00  
:00  !
ReferentialAction00" 3
.003 4
Cascade004 ;
)00; <
;00< =
}11 
)11 
;11 
migrationBuilder33 
.33 
CreateTable33 (
(33( )
name44 
:44 
$str44 %
,44% &
columns55 
:55 
table55 
=>55 !
new55" %
{66 
Id77 
=77 
table77 
.77 
Column77 %
<77% &
int77& )
>77) *
(77* +
type77+ /
:77/ 0
$str771 6
,776 7
nullable778 @
:77@ A
false77B G
)77G H
.88 

Annotation88 #
(88# $
$str88$ 8
,888 9
$str88: @
)88@ A
,88A B
UserId99 
=99 
table99 "
.99" #
Column99# )
<99) *
int99* -
>99- .
(99. /
type99/ 3
:993 4
$str995 :
,99: ;
nullable99< D
:99D E
false99F K
)99K L
,99L M
OsbbId:: 
=:: 
table:: "
.::" #
Column::# )
<::) *
int::* -
>::- .
(::. /
type::/ 3
:::3 4
$str::5 :
,::: ;
nullable::< D
:::D E
false::F K
)::K L
,::L M
Name;; 
=;; 
table;;  
.;;  !
Column;;! '
<;;' (
string;;( .
>;;. /
(;;/ 0
type;;0 4
:;;4 5
$str;;6 E
,;;E F
nullable;;G O
:;;O P
false;;Q V
);;V W
,;;W X
Description<< 
=<<  !
table<<" '
.<<' (
Column<<( .
<<<. /
string<</ 5
><<5 6
(<<6 7
type<<7 ;
:<<; <
$str<<= L
,<<L M
nullable<<N V
:<<V W
false<<X ]
)<<] ^
,<<^ _!
WinnerPollCandidateId== )
===* +
table==, 1
.==1 2
Column==2 8
<==8 9
int==9 <
>==< =
(=== >
type==> B
:==B C
$str==D I
,==I J
nullable==K S
:==S T
false==U Z
)==Z [
,==[ \
Date>> 
=>> 
table>>  
.>>  !
Column>>! '
<>>' (
DateTime>>( 0
>>>0 1
(>>1 2
type>>2 6
:>>6 7
$str>>8 C
,>>C D
nullable>>E M
:>>M N
false>>O T
)>>T U
}?? 
,?? 
constraints@@ 
:@@ 
table@@ "
=>@@# %
{AA 
tableBB 
.BB 

PrimaryKeyBB $
(BB$ %
$strBB% 7
,BB7 8
xBB9 :
=>BB; =
xBB> ?
.BB? @
IdBB@ B
)BBB C
;BBC D
tableCC 
.CC 

ForeignKeyCC $
(CC$ %
nameDD 
:DD 
$strDD T
,DDT U
columnEE 
:EE 
xEE  !
=>EE" $
xEE% &
.EE& '!
WinnerPollCandidateIdEE' <
,EE< =
principalTableFF &
:FF& '
$strFF( 7
,FF7 8
principalColumnGG '
:GG' (
$strGG) -
,GG- .
onDeleteHH  
:HH  !
ReferentialActionHH" 3
.HH3 4
CascadeHH4 ;
)HH; <
;HH< =
}II 
)II 
;II 
migrationBuilderKK 
.KK 
CreateTableKK (
(KK( )
nameLL 
:LL 
$strLL  
,LL  !
columnsMM 
:MM 
tableMM 
=>MM !
newMM" %
{NN 
IdOO 
=OO 
tableOO 
.OO 
ColumnOO %
<OO% &
intOO& )
>OO) *
(OO* +
typeOO+ /
:OO/ 0
$strOO1 6
,OO6 7
nullableOO8 @
:OO@ A
falseOOB G
)OOG H
.PP 

AnnotationPP #
(PP# $
$strPP$ 8
,PP8 9
$strPP: @
)PP@ A
,PPA B
UserIdQQ 
=QQ 
tableQQ "
.QQ" #
ColumnQQ# )
<QQ) *
intQQ* -
>QQ- .
(QQ. /
typeQQ/ 3
:QQ3 4
$strQQ5 :
,QQ: ;
nullableQQ< D
:QQD E
falseQQF K
)QQK L
,QQL M
PollCandidateIdRR #
=RR$ %
tableRR& +
.RR+ ,
ColumnRR, 2
<RR2 3
intRR3 6
>RR6 7
(RR7 8
typeRR8 <
:RR< =
$strRR> C
,RRC D
nullableRRE M
:RRM N
falseRRO T
)RRT U
}SS 
,SS 
constraintsTT 
:TT 
tableTT "
=>TT# %
{UU 
tableVV 
.VV 

PrimaryKeyVV $
(VV$ %
$strVV% 2
,VV2 3
xVV4 5
=>VV6 8
xVV9 :
.VV: ;
IdVV; =
)VV= >
;VV> ?
tableWW 
.WW 

ForeignKeyWW $
(WW$ %
nameXX 
:XX 
$strXX I
,XXI J
columnYY 
:YY 
xYY  !
=>YY" $
xYY% &
.YY& '
PollCandidateIdYY' 6
,YY6 7
principalTableZZ &
:ZZ& '
$strZZ( 7
,ZZ7 8
principalColumn[[ '
:[[' (
$str[[) -
,[[- .
onDelete\\  
:\\  !
ReferentialAction\\" 3
.\\3 4
Cascade\\4 ;
)\\; <
;\\< =
}]] 
)]] 
;]] 
migrationBuilder__ 
.__ 
CreateIndex__ (
(__( )
name`` 
:`` 
$str`` >
,``> ?
tableaa 
:aa 
$straa &
,aa& '
columnbb 
:bb 
$strbb /
)bb/ 0
;bb0 1
migrationBuilderdd 
.dd 
CreateIndexdd (
(dd( )
nameee 
:ee 
$stree /
,ee/ 0
tableff 
:ff 
$strff &
,ff& '
columngg 
:gg 
$strgg  
)gg  !
;gg! "
migrationBuilderii 
.ii 
CreateIndexii (
(ii( )
namejj 
:jj 
$strjj 3
,jj3 4
tablekk 
:kk 
$strkk !
,kk! "
columnll 
:ll 
$strll )
)ll) *
;ll* +
}mm 	
	protectedpp 
overridepp 
voidpp 
Downpp  $
(pp$ %
MigrationBuilderpp% 5
migrationBuilderpp6 F
)ppF G
{qq 	
migrationBuilderrr 
.rr 
	DropTablerr &
(rr& '
namess 
:ss 
$strss %
)ss% &
;ss& '
migrationBuilderuu 
.uu 
	DropTableuu &
(uu& '
namevv 
:vv 
$strvv  
)vv  !
;vv! "
migrationBuilderxx 
.xx 
	DropTablexx &
(xx& '
nameyy 
:yy 
$stryy %
)yy% &
;yy& '
migrationBuilder{{ 
.{{ 
	DropTable{{ &
({{& '
name|| 
:|| 
$str|| 
)|| 
;|| 
}}} 	
}~~ 
} ¯	
[C:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\AnnouncementViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
class !
AnnouncementViewModel "
{ 
public 

int 
AnnouncementId 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public 

string 
Text 
{ 
get 
; 
set !
;! "
}# $
public 

DateTime 
Date 
{ 
get 
; 
set  #
;# $
}% &
public		 

int		 
UserId		 
{		 
get		 
;		 
set		  
;		  !
}		" #
public

 

int

 
OsbbId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
} —

^C:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\ApplicationUserViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
class $
ApplicationUserViewModel %
:& '
IdentityUser( 4
{ 
public 

string 
Surname 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public		 

string		 
PatronymicName		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 

string

 
Role

 
{

 
get

 
;

 
set

 !
;

! "
}

# $
public 

int 
? 
OsbbId 
{ 
get 
; 
set !
;! "
}# $
public 

OsbbViewModel 
? 
Osbb 
{  
get! $
;$ %
set& )
;) *
}+ ,
} Ô	
XC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\ComplaintViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
class 
ComplaintViewModel 
{ 
public 

int 
ComplaintId 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public 

string 
Text 
{ 
get 
; 
set !
;! "
}# $
public 

DateTime 
Date 
{ 
get 
; 
set  #
;# $
}% &
public		 

int		 
UserId		 
{		 
get		 
;		 
set		  
;		  !
}		" #
public

 

int

 
OsbbId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
} ó
YC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\NameRecordViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
record 
NameRecordViewModel !
(! "
string" (
Name) -
)- .
;. /¥
SC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\OsbbViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
class 
OsbbViewModel 
{ 
public 

int 
OsbbId 
{ 
get 
; 
set  
;  !
}" #
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public 

string 
Region 
{ 
get 
; 
set  #
;# $
}% &
public		 

string		 
City		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
public

 

string

 
Street

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

string 
HouseNumber 
{ 
get  #
;# $
set% (
;( )
}* +
public 

ICollection 
< $
ApplicationUserViewModel /
>/ 0
	Residents1 :
{; <
get= @
;@ A
}B C
=D E
newF I
ListJ N
<N O$
ApplicationUserViewModelO g
>g h
(h i
)i j
;j k
public 

OsbbViewModel 
( 
) 
{ 
} 
public 

OsbbViewModel 
( 
string 
name  $
,$ %
string& ,
region- 3
,3 4
string5 ;
city< @
,@ A
stringB H
streetI O
,O P
stringQ W
houseNumberX c
)c d
{ 
this 
. 
Name 
= 
name 
; 
this 
. 
Region 
= 
region 
; 
this 
. 
City 
= 
city 
; 
this 
. 
Street 
= 
street 
; 
this 
. 
HouseNumber 
= 
houseNumber &
;& '
} 
} Ï	
WC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\ProposalViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
class 
ProposalViewModel 
{ 
public 

int 

ProposalId 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public 

string 
Text 
{ 
get 
; 
set !
;! "
}# $
public 

DateTime 
Date 
{ 
get 
; 
set  #
;# $
}% &
public		 

int		 
UserId		 
{		 
get		 
;		 
set		  
;		  !
}		" #
public

 

int

 
OsbbId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
} §
^C:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\TariffAndUserIdViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
class $
TariffAndUserIdViewModel %
{ 
public 

TariffViewModel 
Tariff !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 

string 
UserId 
{ 
get 
; 
set  #
;# $
}% &
} Ï	
UC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\TariffViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
;& '
public 
class 
TariffViewModel 
{ 
public 

int 
TariffId 
{ 
get 
; 
set "
;" #
}$ %
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
public 

decimal 
Cost 
{ 
get 
; 
set "
;" #
}$ %
public		 

int		 
UserId		 
{		 
get		 
;		 
set		  
;		  !
}		" #
public

 

int

 
OsbbId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
} Û
mC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\VotingViewModels\CompletedPollViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
.& '
VotingViewModels' 7
;7 8
public 
class "
CompletedPollViewModel #
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

int 
UserId 
{ 
get 
; 
set  
;  !
}" #
public 

int 
OsbbId 
{ 
get 
; 
set  
;  !
}" #
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public		 

string		 
Description		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
"
PollCandidateViewModel

 !(
WinnerPollCandidateViewModel

" >
{

? @
get

A D
;

D E
set

F I
;

I J
}

K L
public 

DateTime 
Date 
{ 
get 
; 
set  #
;# $
}% &
} Ì
mC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\VotingViewModels\PollCandidateViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
.& '
VotingViewModels' 7
;7 8
public 
class "
PollCandidateViewModel #
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

int 
PollId 
{ 
get 
; 
set  
;  !
}" #
public 

PollViewModel 
PollViewModel &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public		 

ICollection		 
<		 
UserVoteViewModel		 (
>		( )
	UserVotes		* 3
{		4 5
get		6 9
;		9 :
set		; >
;		> ?
}		@ A
public 
"
PollCandidateViewModel !
(! "
)" #
{ 
} 
public 
"
PollCandidateViewModel !
(! "
string" (
name) -
)- .
{ 
Name 
= 
name 
; 
	UserVotes 
= 
new 
List 
< 
UserVoteViewModel .
>. /
(/ 0
)0 1
;1 2
} 
} ñ
dC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\VotingViewModels\PollViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
.& '
VotingViewModels' 7
;7 8
public 
class 
PollViewModel 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

int 
UserId 
{ 
get 
; 
set  
;  !
}" #
public 

int 
OsbbId 
{ 
get 
; 
set  
;  !
}" #
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public		 

string		 
Description		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 

ICollection

 
<

 "
PollCandidateViewModel

 -
>

- .
PollCandidates

/ =
{

> ?
get

@ C
;

C D
set

E H
;

H I
}

J K
public 

DateTime 
Date 
{ 
get 
; 
set  #
;# $
}% &
public 

PollViewModel 
( 
) 
{ 
} 
public 

PollViewModel 
( 
string 
name  $
,$ %
string& ,
description- 8
,8 9
ICollection: E
<E F"
PollCandidateViewModelF \
>\ ]
pollCandidates^ l
)l m
{ 
Name 
= 
name 
; 
Description 
= 
description !
;! "
PollCandidates 
= 
pollCandidates '
;' (
Date 
= 
DateTime 
. 
Now 
; 
} 
} ø
rC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\VotingViewModels\PollWithCandidatesViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
.& '
VotingViewModels' 7
;7 8
public 
class '
PollWithCandidatesViewModel (
{ 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public 

string 
Description 
{ 
get  #
;# $
set% (
;( )
}* +
public 

List 
< "
PollCandidateViewModel &
>& '
	Candidate( 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
} õ
hC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Entities\VotingViewModels\UserVoteViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Entities &
.& '
VotingViewModels' 7
;7 8
public 
class 
UserVoteViewModel 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

int 
UserId 
{ 
get 
; 
set  
;  !
}" #
public 

int 
PollCandidateId 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
"
PollCandidateViewModel !"
PollCandidateViewModel" 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
}		 ≥
KC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\ErrorViewModel.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
; 
public 
class 
ErrorViewModel 
{ 
public 

string 
? 
	RequestId 
{ 
get "
;" #
set$ '
;' (
}) *
public 

bool 
ShowRequestId 
=>  
!! "
string" (
.( )
IsNullOrEmpty) 6
(6 7
	RequestId7 @
)@ A
;A B
} ù#
SC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Models\Mapping\MappingProfile.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Models 
. 
Mapping %
;% &
public		 
class		 
MappingProfile		 
:		 
Profile		 %
{

 
public 

MappingProfile 
( 
) 
{ 
this 
. 
	CreateMap 
< 
ApplicationUser &
,& '$
ApplicationUserViewModel( @
>@ A
(A B
)B C
;C D
this 
. 
	CreateMap 
< $
ApplicationUserViewModel /
,/ 0
ApplicationUser1 @
>@ A
(A B
)B C
;C D
this 
. 
	CreateMap 
< 
Osbb 
, 
OsbbViewModel *
>* +
(+ ,
), -
;- .
this 
. 
	CreateMap 
< 
OsbbViewModel $
,$ %
Osbb& *
>* +
(+ ,
), -
;- .
this 
. 
	CreateMap 
< 
Announcement #
,# $!
AnnouncementViewModel% :
>: ;
(; <
)< =
;= >
this 
. 
	CreateMap 
< !
AnnouncementViewModel ,
,, -
Announcement. :
>: ;
(; <
)< =
;= >
this 
. 
	CreateMap 
< 
Proposal 
,  
ProposalViewModel! 2
>2 3
(3 4
)4 5
;5 6
this 
. 
	CreateMap 
< 
ProposalViewModel (
,( )
Proposal* 2
>2 3
(3 4
)4 5
;5 6
this 
. 
	CreateMap 
< 
	Complaint  
,  !
ComplaintViewModel" 4
>4 5
(5 6
)6 7
;7 8
this 
. 
	CreateMap 
< 
ComplaintViewModel )
,) *
	Complaint+ 4
>4 5
(5 6
)6 7
;7 8
this 
. 
	CreateMap 
< 
Tariff 
, 
TariffViewModel .
>. /
(/ 0
)0 1
;1 2
this 
. 
	CreateMap 
< 
TariffViewModel &
,& '
Tariff( .
>. /
(/ 0
)0 1
;1 2
this 
. 
	CreateMap 
< 
Poll 
, 
PollViewModel *
>* +
(+ ,
), -
;- .
this 
. 
	CreateMap 
< 
PollViewModel $
,$ %
Poll& *
>* +
(+ ,
), -
;- .
this 
. 
	CreateMap 
< 
PollCandidate $
,$ %"
PollCandidateViewModel& <
>< =
(= >
)> ?
;? @
this 
. 
	CreateMap 
< "
PollCandidateViewModel -
,- .
PollCandidate/ <
>< =
(= >
)> ?
;? @
this 
. 
	CreateMap 
< 
UserVote 
,  
UserVoteViewModel! 2
>2 3
(3 4
)4 5
;5 6
this 
. 
	CreateMap 
< 
UserVoteViewModel (
,( )
UserVote* 2
>2 3
(3 4
)4 5
;5 6
this 
. 
	CreateMap 
< 
CompletedPoll $
,$ %"
CompletedPollViewModel& <
>< =
(= >
)> ?
;? @
this   
.   
	CreateMap   
<   "
CompletedPollViewModel   -
,  - .
CompletedPoll  / <
>  < =
(  = >
)  > ?
;  ? @
}!! 
}"" ∂D
=C:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Program.cs
	namespace

 	
YourOSBB


 
.

 
Web

 
;

 
public 
class 
Program 
{ 
public 

static 
async 
Task 
Main !
(! "
string" (
[( )
]) *
args+ /
)/ 0
{ 
var 
builder 
= 
WebApplication $
.$ %
CreateBuilder% 2
(2 3
args3 7
)7 8
;8 9
var 
connectionString 
= 
builder &
.& '
Configuration' 4
.4 5
GetConnectionString5 H
(H I
$strI i
)i j
??k m
thrown s
newt w&
InvalidOperationException	x ë
(
ë í
$str
í —
)
— “
;
“ ”
builder 
. 
Services 
. 
AddDbContext %
<% & 
ApplicationDbContext& :
>: ;
(; <
options 
=> 
options 
. 
UseSqlServer +
(+ ,
connectionString, <
,< =
b 
=> 
b 
. 
MigrationsAssembly )
() *
$str* 8
)8 9
)9 :
): ;
;; <
builder 
. 
Services 
. 
	AddScoped "
<" #
IUnitOfWork# .
,. /

UnitOfWork0 :
>: ;
(; <
)< =
;= >
builder 
. 
Services 
. 
	AddScoped "
<" #
IOsbbService# /
,/ 0
OsbbService1 <
>< =
(= >
)> ?
;? @
builder 
. 
Services 
. 
	AddScoped "
<" ##
IApplicationUserService# :
,: ;"
ApplicationUserService< R
>R S
(S T
)T U
;U V
builder 
. 
Services 
. 
	AddScoped "
<" # 
IAnnouncementService# 7
,7 8
AnnouncementService9 L
>L M
(M N
)N O
;O P
builder 
. 
Services 
. 
	AddScoped "
<" #
IProposalService# 3
,3 4
ProposalService5 D
>D E
(E F
)F G
;G H
builder 
. 
Services 
. 
	AddScoped "
<" #
IComplaintService# 4
,4 5
ComplaintService6 F
>F G
(G H
)H I
;I J
builder 
. 
Services 
. 
	AddScoped "
<" #
ITariffService# 1
,1 2
TariffService3 @
>@ A
(A B
)B C
;C D
builder 
. 
Services 
. 
	AddScoped "
<" #
IVotingService# 1
,1 2
VotingService3 @
>@ A
(A B
)B C
;C D
builder 
. 
Services 
. 
	AddScoped "
<" #
RoleManager# .
<. /
ApplicationRole/ >
>> ?
>? @
(@ A
)A B
;B C
builder   
.   
Services   
.!! 
AddIdentity!! 
<!! 
ApplicationUser!! (
,!!( )
ApplicationRole!!* 9
>!!9 :
(!!: ;
options!!; B
=>!!C E
options!!F M
.!!M N
SignIn!!N T
.!!T U#
RequireConfirmedAccount!!U l
=!!m n
false!!o t
)!!t u
."" 
AddRoles"" 
<"" 
ApplicationRole"" %
>""% &
(""& '
)""' (
.## 
AddDefaultUI## 
(## 
)## 
.$$ $
AddEntityFrameworkStores$$ %
<$$% & 
ApplicationDbContext$$& :
>$$: ;
($$; <
)$$< =
.%% $
AddDefaultTokenProviders%% %
(%%% &
)%%& '
;%%' (
builder'' 
.'' 
Services'' 
.'' 
AddAutoMapper'' &
(''& '
typeof''' -
(''- .
Program''. 5
)''5 6
.''6 7
Assembly''7 ?
)''? @
;''@ A
builder** 
.** 
Services** 
.** 
AddRazorPages** &
(**& '
)**' (
;**( )
builder++ 
.++ 
Services++ 
.++ #
AddControllersWithViews++ 0
(++0 1
)++1 2
;++2 3
builder,, 
.,, 
Services,, 
.,, 
AddHealthChecks,, (
(,,( )
),,) *
;,,* +
var.. 
app.. 
=.. 
builder.. 
... 
Build.. 
(..  
)..  !
;..! "
if11 

(11 
!11 
app11 
.11 
Environment11 
.11 
IsDevelopment11 *
(11* +
)11+ ,
)11, -
{22 	
app33 
.33 
UseExceptionHandler33 #
(33# $
$str33$ 1
)331 2
;332 3
app55 
.55 
UseHsts55 
(55 
)55 
;55 
}66 	
List99 
<99 
dynamic99 
>99 
hList99 
=99 
new99 !
List99" &
<99& '
dynamic99' .
>99. /
(99/ 0
)990 1
{992 3
$num994 5
,995 6
$str997 ;
}99; <
;99< =
foreach:: 
(:: 
var:: 
v:: 
in:: 
hList:: 
)::  
{;; 	
System<< 
.<< 
Console<< 
.<< 
	WriteLine<< $
(<<$ %
v<<% &
)<<& '
;<<' (
}== 	
app@@ 
.@@ 
UseHttpsRedirection@@ 
(@@  
)@@  !
;@@! "
appAA 
.AA 
UseStaticFilesAA 
(AA 
)AA 
;AA 
appCC 
.CC 

UseRoutingCC 
(CC 
)CC 
;CC 
appEE 
.EE 
UseAuthorizationEE 
(EE 
)EE 
;EE 
appGG 
.GG 
MapRazorPagesGG 
(GG 
)GG 
;GG 
appII 
.II 
MapControllerRouteII 
(II 
nameJJ 
:JJ 
$strJJ 
,JJ 
patternKK 
:KK 
$strKK =
)KK= >
;KK> ?
usingMM 
(MM 
varMM 
scopeMM 
=MM 
appMM 
.MM 
ServicesMM '
.MM' (
CreateScopeMM( 3
(MM3 4
)MM4 5
)MM5 6
{NN 	
varOO 
roleManagerOO 
=OO 
scopePP 
.PP 
ServiceProviderPP %
.PP% &
GetRequiredServicePP& 8
<PP8 9
RoleManagerPP9 D
<PPD E
ApplicationRolePPE T
>PPT U
>PPU V
(PPV W
)PPW X
;PPX Y
varRR 
rolesRR 
=RR 
newRR 
[RR 
]RR 
{RR 
$strRR  '
,RR' (
$strRR) 3
,RR3 4
$strRR5 ?
}RR@ A
;RRA B
foreachTT 
(TT 
varTT 
roleTT 
inTT  
rolesTT! &
)TT& '
{UU 
ifVV 
(VV 
!VV 
awaitVV 
roleManagerVV &
.VV& '
RoleExistsAsyncVV' 6
(VV6 7
roleVV7 ;
)VV; <
)VV< =
awaitWW 
roleManagerWW %
.WW% &
CreateAsyncWW& 1
(WW1 2
newWW2 5
ApplicationRoleWW6 E
(WWE F
roleWWF J
)WWJ K
)WWK L
;WWL M
}XX 
}YY 	
app[[ 
.[[ 
Run[[ 
([[ 
)[[ 
;[[ 
}\\ 
}]] Á
TC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Views\Resident\Resident.cshtml.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Views 
. 
Resident %
;% &
public 
class 
Resident 
: 
	PageModel !
{ 
public 

void 
OnGet 
( 
) 
{ 
}

 
} Á
TC:\Users\vanya\RiderProjects\YourOSBB\YourOSBB.Web\Views\OsbbHead\OsbbHead.cshtml.cs
	namespace 	
YourOSBB
 
. 
Web 
. 
Views 
. 
OsbbHead %
;% &
public 
class 
OsbbHead 
: 
	PageModel !
{ 
public 

void 
OnGet 
( 
) 
{ 
}

 
} 